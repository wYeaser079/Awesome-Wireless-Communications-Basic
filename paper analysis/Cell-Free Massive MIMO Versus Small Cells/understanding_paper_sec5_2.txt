
â•­â”€â”€â”€ Claude Code v2.1.63 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                    â”‚ Tips for getting        â”‚
â”‚             Welcome back Tech Shottify!            â”‚ started                 â”‚
â”‚                                                    â”‚ Run /init to create a â€¦ â”‚
â”‚                       â–â–›â–ˆâ–ˆâ–ˆâ–œâ–Œ                      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                      â–â–œâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–›â–˜                     â”‚ Recent activity         â”‚
â”‚                        â–˜â–˜ â–â–                       â”‚ No recent activity      â”‚
â”‚                                                    â”‚                         â”‚
â”‚               Opus 4.6 Â· Claude Max                â”‚                         â”‚
â”‚   F:\Codes\Awesome-Wireless-Communications-Basic   â”‚                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â¯ read this file:                                                           
  @"paper analysis/Cell-Free Massive MIMO Versus Small                      
  Cells/understanding_paper_sec2.txt" ,                                     
  Now help me to understand section 3 in the same way.                      
  â¿ Â Read paper analysis\Cell-Free Massive MIMO Versus Small 
     Cells\understanding_paper_sec2.txt (1083 lines)

â— I've read the file â€” it contains your previous deep dive into Section II
  (system model, uplink training, downlink/uplink data transmission). Now let me
   prepare the same level of deep dive for Section III (Performance Analysis).

  Let me first re-read the paper's Section III and do thorough research.

â— Agent(Extract Section III from paper)
  â¿ Â Done (7 tool uses Â· 36.8k tokens Â· 2m 18s)
  (ctrl+o to expand)

â— Agent(Research Massive MIMO rate analysis)
  â¿ Â Done (48 tool uses Â· 55.9k tokens Â· 28m 0s)
  (ctrl+o to expand)

â— Now I have thorough research on both the paper content and background theory.
  Let me write the complete deep dive.

  ---
  SECTION III: PERFORMANCE ANALYSIS â€” Complete Deep Dive

  ---
  CHUNK 1: The High-Level Picture & Asymptotic Analysis (Section III-A)

  1.1 What This Section Is About (Simple Terms)

  Section II told us how the system works â€” pilots, beamforming, matched
  filtering. Section III answers: how well does it work? It derives exact
  formulas for the data rate each user can achieve.

  The section has two parts:
  - III-A: What happens when M â†’ âˆ (infinite APs)? This reveals the fundamental
  limits.
  - III-B: What is the exact rate for any finite M and K? This gives the
  formulas we'll actually implement.

  Think of III-A as the "dream scenario" that shows you the theoretical ceiling,
   and III-B as the "real-world formula" that tells you exactly where you stand.

  ---
  1.2 Why Do We Need Rate Expressions?

  In wireless, we measure performance by achievable rate (bits/sec/Hz). A rate
  expression tells us:
  - How much data each user can receive/send
  - How the system scales with M and K
  - Where the bottlenecks are
  - What to optimize (power control, pilot assignment)

  Without closed-form rate expressions, we'd need Monte Carlo simulations for
  every parameter setting â€” impractical for optimization.

  ---
  1.3 The Asymptotic Regime: M â†’ âˆ (Section III-A)

  Let's start from the downlink received signal at user k (from Section II, Eq.
  9):

                  M     K
  r_{d,k} = âˆšÏ_d Â· Î£    Î£  âˆšÎ·_{mk'} Â· g_{mk} Â· Ä*_{mk'} Â· q_{k'}  +  w_{d,k}
                 m=1  k'=1

  Splitting into desired signal (DS) and multi-user interference (MUI):

               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€ DS_k â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ MUI_k â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  M                           M     K
  r_{d,k} = âˆšÏ_dÂ·Î£ âˆšÎ·_{mk}Â·g_{mk}Â·Ä*_{mk}Â·q_k + âˆšÏ_dÂ·Î£    Î£
  âˆšÎ·_{mk'}Â·g_{mk}Â·Ä*_{mk'}Â·q_{k'} + w_{d,k}
                 m=1                         m=1  k'â‰ k

  The key question: What happens to DS_k and MUI_k as M â†’ âˆ?

  ---
  1.4 Tchebyshev's Theorem â€” The Mathematical Engine

  The tool that drives the asymptotic analysis is Tchebyshev's theorem (a form
  of the weak law of large numbers):

  If Xâ‚, Xâ‚‚, ..., Xâ‚™ are independent random variables with E{Xáµ¢} = Î¼áµ¢ and 
  Var{Xáµ¢} â‰¤ c < âˆ for all i, then:

  (1/n)Â·(Xâ‚ + Xâ‚‚ + Â·Â·Â· + Xâ‚™) âˆ’ (1/n)Â·(Î¼â‚ + Î¼â‚‚ + Â·Â·Â· + Î¼â‚™) â†’ 0 in probability

  In words: the average of independent, bounded-variance random variables
  converges to the average of their means. The random fluctuations cancel out.

  Why this matters for Massive MIMO: Each AP contributes one independent term to
   the sum. With M APs (M large), the sum of M independent terms concentrates
  around its mean.

  ---
  1.5 Applying Tchebyshev to the Inner Products

  The critical inner product is (using the channel estimate from Eq. 4):

    M
    Î£  âˆšÎ·_{mk'} Â· g_{mk} Â· Ä*_{mk'}
   m=1

  Substituting Ä_{mk'} = c_{mk'} Â· Å·_{p,mk'} and expanding Å·_{p,mk'}:

    M                              M                               K
    Î£ âˆšÎ·_{mk'}Â·g_{mk}Â·Ä*_{mk'} = Î£ âˆšÎ·_{mk'}Â·c_{mk'}Â·g_{mk}Â·[âˆš(Ï„_pÂ·Ï_p)Â· Î£
  g*_{mi}Â·Ï†*_{k'}Â·Ï†áµ¢ + wÌƒ*_{p,mk'}]
   m=1                            m=1                             i=1

  Each term in the sum over m is independent (different APs have independent
  channels). By Tchebyshev's theorem, as M â†’ âˆ: Eq. (14)

    1   M                                           1   M
   â”€â”€â”€ Â· Î£ âˆšÎ·_{mk'}Â·g_{mk}Â·Ä*_{mk'} âˆ’ âˆš(Ï„_pÂ·Ï_p)Â·â”€â”€â”€ Â· Î£
  âˆšÎ·_{mk'}Â·c_{mk'}Â·Î²_{mk}Â·Ï†*_kÂ·Ï†_{k'} â†’ 0
    M  m=1                                          M  m=1

  Let me explain what happened here:
  - The noise term wÌƒ_{p,mk'} is independent of g_{mk}, so E{g_{mk}Â·wÌƒ*_{p,mk'}} =
   0 â†’ this term vanishes
  - Cross terms g_{mk}Â·g*_{mi} for i â‰  k have E{g_{mk}Â·g*_{mi}} = 0 â†’ these
  vanish too
  - Only the i = k term survives: E{g_{mk}Â·g*_{mk}} = E{|g_{mk}|Â²} = Î²_{mk}

  ---
  1.6 What Survives as M â†’ âˆ

  Applying this to DS_k and MUI_k separately:

  Desired signal (Eq. 15): Setting k' = k:
    1                              1   M
   â”€â”€â”€ Â· DS_k â†’ âˆš(Ï„_pÂ·Ï_pÂ·Ï_d) Â· â”€â”€â”€ Â· Î£ âˆšÎ·_{mk}Â·c_{mk}Â·Î²_{mk} Â· q_k
  (deterministic!)
    M                              M  m=1

  Multi-user interference (Eq. 16): For k' â‰  k:
    1                              1   M
   â”€â”€â”€ Â· MUI_k â†’ âˆš(Ï„_pÂ·Ï_pÂ·Ï_d) Â· Î£  [â”€â”€â”€ Â· Î£ âˆšÎ·_{mk'}Â·c_{mk'}Â·Î²_{mk}] Â·
  Ï†*_kÂ·Ï†_{k'} Â· q_{k'}
    M                             k'â‰ k  M  m=1

  The crucial observation: The interference term has a factor Ï†*k Â· Ï†{k'}.

  - If Ï†*k Â· Ï†{k'} = 0 (orthogonal pilots): Interference vanishes completely! â†’
  Eq. (18)
  - If Ï†*k Â· Ï†{k'} â‰  0 (shared pilots): Interference persists even as M â†’ âˆ â†’
  Eq. (17)

  This is pilot contamination â€” the only impairment that survives infinite M.

  ---
  1.7 Favorable Propagation â€” Why Interference Disappears

  The disappearance of non-coherent interference is called favorable 
  propagation. Physically:

    M
    Î£  g*_{mk} Â· g_{mk'}    (inner product of channel vectors of users k and k')
   m=1

  When k â‰  k' and they use different pilots, Ä_{mk} is independent of g_{mk'}.
  The M terms in the sum are independent with zero mean â†’ by LLN, the sum
  divided by M â†’ 0.

    Users with orthogonal pilots:

         g_k = [g_{1k}, g_{2k}, ..., g_{Mk}]áµ€
         g_{k'} = [g_{1k'}, g_{2k'}, ..., g_{Mk'}]áµ€

         (1/M) Â· g*_k Â· g_{k'} â†’ 0    as M â†’ âˆ

         The channel vectors become orthogonal!

  But when users share a pilot, Ä_{mk} contains a coherent component of g_{mk'}
  (from the contamination). This coherent component adds up constructively
  across all M APs:

    Users sharing pilots:

         Ä_{mk} âˆ c_{mk} Â· (âˆš(Ï„_pÂ·Ï_p) Â· g_{mk} + âˆš(Ï„_pÂ·Ï_p) Â· g_{mk'} + noise)
                                                       â†‘ contamination

         Î£_m g_{mk} Â· Ä*_{mk}  contains  Î£_m |g_{mk}|Â² (desired, ~ M)
         Î£_m g_{mk'} Â· Ä*_{mk} contains  Î£_m Î²_{mk} Â· c_{mk} (contamination,
  also ~ M)

         Both scale linearly with M â†’ ratio saturates â†’ pilot contamination is
  permanent!

  ---
  1.8 Numerical Example â€” Asymptotic Behavior

  Setup: K = 4 users, Ï„_p = 2 pilots â†’ Users {1,3} share pilot 1, Users {2,4}
  share pilot 2.

  As M â†’ âˆ, the downlink signal at User 1 becomes:

  r_{d,1}/âˆšM â†’ âˆš(Ï„_pÂ·Ï_pÂ·Ï_dÂ·M) Â· [
     Î£_m âˆšÎ·_{m1}Â·c_{m1}Â·Î²_{m1} Â· qâ‚           â† desired signal (always present)
   + Î£_m âˆšÎ·_{m3}Â·c_{m3}Â·Î²_{m1} Â· qâ‚ƒ           â† pilot contamination from User 3
   + 0 Â· qâ‚‚                                     â† User 2 (orthogonal pilot):
  GONE
   + 0 Â· qâ‚„                                     â† User 4 (orthogonal pilot):
  GONE
  ]

  Noise: GONE. Interference from Users 2,4: GONE. Only User 3's interference
  survives (same pilot).

  ---
  CHUNK 2: Achievable Downlink Rate â€” Theorem 1 (Section III-B1)

  2.1 The High-Level Picture

  The asymptotic analysis (M â†’ âˆ) tells us what vanishes. But we need a rate
  formula for finite M (e.g., M = 100). This is Theorem 1 â€” the central result
  of the paper.

  The challenge: for finite M, noise, beamforming uncertainty, and all
  interference are present. We need to quantify every source of impairment
  precisely.

  ---
  2.2 The Use-and-Then-Forget (UatF) Bounding Technique

  The key problem: user k does not know the instantaneous effective channel
  gain. In a standard system, the user would estimate the downlink channel.
  Here, thanks to channel hardening, the user relies only on statistics (the
  mean of the effective channel).

  The technique, called the "Use-and-Then-Forget" (UatF) bound:

  1. Use: The AP uses its channel estimate Ä_{mk} for beamforming
  2. Forget: The user decodes as if it only knows E{effective channel}, treating
   all deviations as noise

  The name captures the philosophy: channel estimates are used to design
  beamformers, then forgotten at the decoder.

  ---
  2.3 Signal Decomposition â€” Equations (19)â€“(22)

  The received signal at user k is rewritten as:

  r_{d,k} = DS_k Â· q_k + BU_k Â· q_k + Î£_{k'â‰ k} UI_{kk'} Â· q_{k'} + w_{d,k}
  ... (19)

  where three key quantities are defined:

  DS_k (Desired Signal strength) â€” Eq. (20):
                          M
  DS_k = âˆšÏ_d Â· E{ Î£  âˆšÎ·_{mk} Â· g_{mk} Â· Ä*_{mk} }
                         m=1
  This is the mean of the effective channel gain â€” deterministic, known to the
  user.

  BU_k (Beamforming Uncertainty) â€” Eq. (21):
                   M                           M
  BU_k = âˆšÏ_d Â· [ Î£  âˆšÎ·_{mk}Â·g_{mk}Â·Ä*_{mk} âˆ’ E{ Î£  âˆšÎ·_{mk}Â·g_{mk}Â·Ä*_{mk} } ]
                  m=1                         m=1
  This is the random fluctuation of the effective channel around its mean. The
  user cannot track this â€” it acts as self-interference.

  UI_{kk'} (Inter-User Interference) â€” Eq. (22):
                      M
  UI_{kk'} = âˆšÏ_d Â· Î£  âˆšÎ·_{mk'} Â· g_{mk} Â· Ä*_{mk'}
                     m=1
  This is the leakage from user k' into user k's signal.

  Visually:

  r_{d,k} =  [ DS_k ]  Â· q_k  +  [ BU_k ]  Â· q_k  +   Î£   [ UI_{kk'} ] Â· q_{k'}
   +  w_{d,k}
              â†‘ known              â†‘ unknown              k'â‰ k  â†‘ unknown
           â†‘ noise
              (signal)             (self-interference)          (multi-user
  interference)

  ---
  2.4 Why This Decomposition Works â€” The Worst-Case Noise Argument

  Critical property: DS_k and BU_k are uncorrelated:

  E{DS_k Â· BU*_k} = E{DS_k Â· [a_k âˆ’ E{a_k}]*} = DS_k Â· [E{a*_k} âˆ’ E{a*_k}] = 0

  where a_k = Î£_m âˆšÎ·_{mk} Â· g_{mk} Â· Ä*_{mk} is the effective channel.

  Similarly, UI_{kk'} is uncorrelated with DS_k Â· q_k.

  Now the key information-theoretic argument:

  Among all additive noise distributions with a given variance, Gaussian noise 
  minimizes the mutual information (capacity). Therefore, replacing the actual 
  non-Gaussian effective noise (BU + UI + thermal) with Gaussian noise of the 
  same power gives a valid lower bound on the achievable rate.

  This yields: Eq. (23)

                           |DS_k|Â²
  R_{d,k} = logâ‚‚(1 + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ )
                       E{|BU_k|Â²} + Î£_{k'â‰ k} E{|UI_{kk'}|Â²} + 1

  The structure is:

           (signal power from the KNOWN part of the channel)
  SINR = â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         (variance of channel uncertainty) + (interference power) + (noise)

  ---
  2.5 Computing Each Term â€” The Proof of Theorem 1

  Now we compute DS_k, E{|BU_k|Â²}, and E{|UI_{kk'}|Â²} in closed form. This is
  Appendix A of the paper. Let me walk through each.

  Step 1: Compute DS_k (Eq. 59)

  Using the decomposition g_{mk} = Ä_{mk} + Îµ_{mk} (estimate + error), where
  Ä_{mk} and Îµ_{mk} are independent (MMSE property):

                      M
  DS_k = âˆšÏ_d Â· E{ Î£  âˆšÎ·_{mk} Â· (Ä_{mk} + Îµ_{mk}) Â· Ä*_{mk} }
                     m=1

                M
       = âˆšÏ_d Â· Î£  âˆšÎ·_{mk} Â· ( E{|Ä_{mk}|Â²} + E{Îµ_{mk}} Â· E{Ä*_{mk}} )
                m=1                  â†‘                    â†‘
                                  = Î³_{mk}             = 0 (zero mean,
  independent)

                M
       = âˆšÏ_d Â· Î£  âˆšÎ·_{mk} Â· Î³_{mk}                                        ...
  (59)
                m=1

  Step 2: Compute E{|BU_k|Â²} (Eq. 60)

  BU_k is the sum of M independent zero-mean terms (centered by subtracting
  DS_k). The variance of a sum of independent RVs equals the sum of variances:

  E{|BU_k|Â²} = Ï_d Â· Î£_{m=1}^{M} Î·_{mk} Â· Var{g_{mk} Â· Ä*_{mk}}

  For each term:
  Var{g_{mk} Â· Ä*_{mk}} = E{|g_{mk} Â· Ä*_{mk}|Â²} âˆ’ |E{g_{mk} Â· Ä*_{mk}}|Â²
                          = E{|g_{mk}|Â² Â· |Ä_{mk}|Â²} âˆ’ Î³Â²_{mk}

  Using g_{mk} = Ä_{mk} + Îµ_{mk}:
  E{|g_{mk}|Â² Â· |Ä_{mk}|Â²} = E{|Ä_{mk} + Îµ_{mk}|Â² Â· |Ä_{mk}|Â²}
                              = E{|Ä_{mk}|â´} + E{|Îµ_{mk}|Â²} Â· E{|Ä_{mk}|Â²}
                                    â†‘                â†‘              â†‘
                                 = 2Î³Â²_{mk}    = Î²_{mk}âˆ’Î³_{mk}   = Î³_{mk}

  (For a CN(0,ÏƒÂ²) variable X: E{|X|â´} = 2Ïƒâ´. This is the fourth moment of a
  complex Gaussian.)

  So:
  Var{g_{mk}Â·Ä*_{mk}} = 2Î³Â²_{mk} + (Î²_{mk} âˆ’ Î³_{mk})Â·Î³_{mk} âˆ’ Î³Â²_{mk}
                        = Î³Â²_{mk} + Î²_{mk}Â·Î³_{mk} âˆ’ Î³Â²_{mk}
                        = Î³_{mk} Â· Î²_{mk}

  Therefore: Eq. (60)
  E{|BU_k|Â²} = Ï_d Â· Î£_{m=1}^{M} Î·_{mk} Â· Î³_{mk} Â· Î²_{mk}

  Step 3: Compute E{|UI_{kk'}|Â²} (Eqs. 61â€“68)

  This is the most involved step. The interference from user k' has two
  components:
  - A coherent part (from pilot contamination, when Ï†*k Â· Ï†{k'} â‰  0)
  - An incoherent part (always present)

  After careful derivation (expanding the estimate, using independence of
  channels across APs, and the fourth moment formula): Eq. (68)

                                                             M
                          M
  E{|UI_{kk'}|Â²} = Ï_d Â· |Ï†*_k Â· Ï†_{k'}|Â² Â· ( Î£  âˆšÎ·_{mk'} Â· Î³_{mk'} Â·
  Î²_{mk}/Î³_{mk'} )Â²  +  Ï_d Â· Î£  Î·_{mk'} Â· Î³_{mk'} Â· Î²_{mk}
                                                            m=1
                         m=1

  The first term is the coherent interference (pilot contamination) â€” note it's
  a squared sum, scaling as MÂ². The second term is incoherent interference â€” a
  simple sum, scaling as M.

  ---
  2.6 Putting It All Together â€” Theorem 1, Eq. (24)

  Substituting DS_k, E{|BU_k|Â²}, and E{|UI_{kk'}|Â²} into Eq. (23): THE CENTRAL 
  EQUATION

                                          Ï_d Â· ( Î£_{m=1}^{M} âˆšÎ·_{mk} Â· Î³_{mk}
  )Â²
  R_{d,k} = logâ‚‚( 1 + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ )
                        Ï_d Â· Î£_{k'=1}^{K} Î£_{m=1}^{M} Î·_{mk'} Â· Î³_{mk'} Â·
  Î²_{mk}
                        + Ï_d Â· Î£_{k'â‰ k} |Ï†*_kÂ·Ï†_{k'}|Â² Â· ( Î£_{m=1}^{M}
  âˆšÎ·_{mk'}Â·c_{mk'}Â·Î²_{mk} )Â²
                        + 1

  Let me label each part of the denominator:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  NUMERATOR:  Ï_d Â· ( Î£_m âˆšÎ·_{mk} Â· Î³_{mk} )Â²                      â”‚
  â”‚              â†‘ Squared sum of coherent gains from all M APs          â”‚
  â”‚              This is |DS_k|Â² â€” the signal power                      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  DENOMINATOR TERM 1:  Ï_d Â· Î£_{k'} Î£_m Î·_{mk'} Â· Î³_{mk'} Â· Î²_{mk} â”‚
  â”‚              â†‘ Non-coherent interference + beamforming uncertainty    â”‚
  â”‚              This = E{|BU_k|Â²} + incoherent part of Î£ E{|UI_{kk'}|Â²}â”‚
  â”‚              Scales as O(M) â€” grows linearly                         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  DENOMINATOR TERM 2:  Ï_d Â· Î£_{k'â‰ k} |Ï†*_kÂ·Ï†_{k'}|Â² Â· (...)Â²      â”‚
  â”‚              â†‘ Coherent pilot contamination interference              â”‚
  â”‚              Only from co-pilot users (|Ï†*_kÂ·Ï†_{k'}|Â² = 1)           â”‚
  â”‚              This is a SQUARED SUM â€” scales as O(MÂ²)                 â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  DENOMINATOR TERM 3:  1  =  noise                                    â”‚
  â”‚              â†‘ Thermal noise (constant, doesn't scale with M)         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Scaling behavior as M â†’ âˆ:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚           Component            â”‚ Scaling â”‚            Effect            â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Numerator (signal)             â”‚ O(MÂ²)   â”‚ Grows quadratically          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Denom Term 1 (non-coherent)    â”‚ O(M)    â”‚ Drowned out by numerator     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Denom Term 2 (pilot            â”‚ O(MÂ²)   â”‚ Stays competitive with       â”‚
  â”‚ contamination)                 â”‚         â”‚ numerator                    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Denom Term 3 (noise)           â”‚ O(1)    â”‚ Completely negligible        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  As M â†’ âˆ:   SINR â†’ (Î£_m âˆšÎ·_{mk}Â·Î³_{mk})Â² / Î£_{k'â‰ k,co-pilot} (Î£_m
  âˆšÎ·_{mk'}Â·c_{mk'}Â·Î²_{mk})Â²

  The rate saturates â€” it doesn't grow forever. Pilot contamination creates a 
  ceiling.

  ---
  2.7 Numerical Example â€” Downlink Rate Computation

  Setup: M = 4 APs, K = 2 users, Ï„_p = 1 (both users share the same pilot!), Ï_d
   = 10 dB = 10.

  Large-scale fading:

  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚      â”‚ Î²_{m1} â”‚ Î²_{m2} â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ AP 1 â”‚ 0.5    â”‚ 0.1    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ AP 2 â”‚ 0.3    â”‚ 0.4    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ AP 3 â”‚ 0.1    â”‚ 0.6    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ AP 4 â”‚ 0.2    â”‚ 0.2    â”‚
  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  With Ï„_p = 1 and both users sharing the pilot (|Ï†*â‚Â·Ï†â‚‚|Â² = 1):

  MMSE coefficient: c_{mk} = âˆš(Ï„_pÂ·Ï_p) Â· Î²_{mk} / (Ï„_pÂ·Ï_p Â· (Î²_{m1} + Î²_{m2})
  + 1)

  Let Ï_p = 10 (training SNR = 10 dB), so Ï„_pÂ·Ï_p = 10.

  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  m  â”‚ Î²_{m1}+Î²_{m2} â”‚   c_{m1}   â”‚   c_{m2}   â”‚    Î³_{m1}     â”‚ Î³_{m2} â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 1   â”‚ 0.6           â”‚ âˆš10Â·0.5/7  â”‚ âˆš10Â·0.1/7  â”‚ 10Â·0.5Â·0.226  â”‚ 0.045  â”‚
  â”‚     â”‚               â”‚ = 0.226    â”‚ = 0.045    â”‚ = 1.13        â”‚        â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 2   â”‚ 0.7           â”‚ âˆš10Â·0.3/8  â”‚ âˆš10Â·0.4/8  â”‚ 0.356         â”‚ 0.632  â”‚
  â”‚     â”‚               â”‚ = 0.119    â”‚ = 0.158    â”‚               â”‚        â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 3   â”‚ 0.7           â”‚ âˆš10Â·0.1/8  â”‚ âˆš10Â·0.6/8  â”‚ 0.040         â”‚ 1.424  â”‚
  â”‚     â”‚               â”‚ = 0.040    â”‚ = 0.237    â”‚               â”‚        â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 4   â”‚ 0.4           â”‚ âˆš10Â·0.2/5  â”‚ âˆš10Â·0.2/5  â”‚ 0.253         â”‚ 0.253  â”‚
  â”‚     â”‚               â”‚ = 0.126    â”‚ = 0.126    â”‚               â”‚        â”‚
  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  (Approximate values for illustration.)

  With equal power control Î·_{mk} = 1/(KÂ·max_m Î³_{mk}):

  Numerator for user 1: Ï_d Â· (Î£_m âˆšÎ·_{m1}Â·Î³_{m1})Â² â€” the coherent sum of all
  APs' contributions.

  The point: every quantity in Eq. (24) is computable from the large-scale 
  fading coefficients Î²_{mk} alone. No instantaneous channel knowledge needed.

  ---
  2.8 Remark 3 â€” Connection to Collocated Massive MIMO (Eq. 25)

  If all APs are collocated (same location): Î²_{mk} = Î²_k for all m, Î³_{mk} =
  Î³_k for all m. With a total (not per-AP) power constraint and orthogonal
  pilots:

                             M Â· Ï_d Â· Î·_k Â· Î³_k
  R_{d,k} = logâ‚‚( 1 + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ )                    ... (25)
                        Ï_d Â· Î£_{k'} Î·_{k'} + 1

  This is the classical collocated Massive MIMO rate from [3] (Ngo, Larsson,
  Marzetta, 2013). So Cell-Free is a strict generalization â€” collocated is a
  special case.

  ---
  2.9 Remark 4 â€” Channel Hardening Validation (Fig. 2, Eq. 26)

  To verify that the user can safely decode using only statistics (not
  instantaneous channel), the paper compares:

  - Eq. (24): Rate assuming user knows only E{effective channel} (the UatF
  bound)
  - Eq. (26): Rate assuming a "genie" tells the user the exact instantaneous
  effective channel

                                      Ï_d Â· | Î£_m âˆšÎ·_{mk}Â·g_{mk}Â·Ä*_{mk} |Â²
  RÌƒ_{d,k} = E{ logâ‚‚( 1 + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ )
  }     ... (26)
                            Î£_{k'â‰ k} | Î£_m âˆšÎ·_{mk'}Â·g_{mk}Â·Ä*_{mk'} |Â² + 1

  Figure 2 shows the gap is small (a few percent), confirming channel hardening
  works. The intuition: with M = 100 APs, the effective channel Î£_m
  âˆšÎ·_{mk}Â·g_{mk}Â·Ä*_{mk} is a sum of ~100 independent terms. By the law of large
   numbers, this sum concentrates around its mean. The "randomness" is small
  relative to the mean.

  Important nuance: Channel hardening is weaker in Cell-Free than in collocated
  systems. In collocated, all M terms have the same variance (same Î²_k), giving
  variance/meanÂ² = 1/M. In Cell-Free, the Î²_{mk} values vary widely â€” nearby APs
   dominate. The "effective number" of APs is ~10-20, not 100. But this is still
   enough for hardening to work reasonably well.

  ---
  CHUNK 3: Achievable Uplink Rate â€” Theorem 2 (Section III-B2)

  3.1 The High-Level Picture

  The uplink rate derivation follows the same philosophy as the downlink:
  decompose the signal, treat deviations from the mean as noise, apply the
  worst-case Gaussian argument. But the uplink has a different signal structure
  (combining happens at the CPU, not over the air).

  ---
  3.2 The Uplink SINR â€” Theorem 2, Eq. (27)

  The CPU detects user k from the combined signal r_{u,k} = Î£_{m=1}^{M} Ä*{mk} Â·
   y{u,m} (from Eq. 11). Using the same UatF technique:

                                          Ï_u Â· p_k Â· ( Î£_{m=1}^{M} Î³_{mk} )Â²
  R_{u,k} = logâ‚‚( 1 + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ )
                        Ï_u Â· Î£_{k'â‰ k} p_{k'} Â· |Ï†*_kÂ·Ï†_{k'}|Â² Â· ( Î£_{m=1}^{M}
  Î³_{mk}Â·Î²_{mk'}/Î³_{mk'} )Â²
                        + Ï_u Â· Î£_{k'=1}^{K} p_{k'} Â· Î£_{m=1}^{M} Î³_{mk} Â·
  Î²_{mk'}
                        + Î£_{m=1}^{M} Î³_{mk}
  ... (27)

  where p_k âˆˆ [0, 1] is the uplink power control coefficient for user k.

  ---
  3.3 Comparing Downlink vs. Uplink SINR Structure

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”
  â”‚    Component     â”‚        Downlink (Eq. 24)      â”‚       Uplink (Eq. 27)
      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”¤
  â”‚ Numerator        â”‚ Ï_dÂ·(Î£_m âˆšÎ·_{mk}Â·Î³_{mk})Â²   â”‚ Ï_uÂ·p_kÂ·(Î£_m Î³_{mk})Â²
   â”‚
  â”‚                  â”‚ â†‘ power control per AP-user   â”‚ â†‘ no per-AP power control
       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”¤
  â”‚ Pilot contam.    â”‚ |Ï†*_kÂ·Ï†_{k'}|Â²Â·              â”‚ |Ï†*_kÂ·Ï†_{k'}|Â²Â·
     â”‚
  â”‚ (coherent)       â”‚ (Î£_m âˆšÎ·_{mk'}Â·c_{mk'}Â·Î²_{mk})Â²â”‚ (Î£_m
  Î³_{mk}Â·Î²_{mk'}/Î³_{mk'})Â²â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”¤
  â”‚ Non-coherent     â”‚ Î£_{k'} Î£_m Î·_{mk'}Â·Î³_{mk'}  â”‚ Î£_{k'} p_{k'}Â·
   â”‚
  â”‚ interference     â”‚         Â·Î²_{mk}               â”‚   Î£_m Î³_{mk}Â·Î²_{mk'}
     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”¤
  â”‚ Noise            â”‚ 1                              â”‚ Î£_m Î³_{mk}
       â”‚
  â”‚                  â”‚                                â”‚ (noise amplified by MF)
        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”¤
  â”‚ Power control    â”‚ Î·_{mk} (M Ã— K variables)      â”‚ p_k (K variables)
       â”‚
  â”‚ complexity       â”‚                                â”‚
        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”˜

  Key differences:

  1. Power control granularity: Downlink has MÃ—K power coefficients Î·_{mk} (one
  per AP-user pair). Uplink has only K coefficients p_k (one per user). Uplink
  optimization is much simpler.
  2. Numerator structure: In downlink, âˆšÎ·_{mk} appears inside the sum â€” each AP
  can weight its contribution to each user differently. In uplink, p_k is
  outside the sum â€” the user broadcasts with a single power level.
  3. Noise term: In downlink, noise at the user is just 1. In uplink, noise at
  the CPU after matched filtering is Î£_m Î³_{mk} â€” each AP's matched filter
  amplifies noise by Î³_{mk}, and these add up.

  ---
  3.4 Why the Uplink Numerator Has (Î£_m Î³_{mk})Â² Instead of (Î£_m 
  âˆšÎ·_{mk}Â·Î³_{mk})Â²

  In the uplink, the matched filter weight at AP m is Ä*_{mk} (fixed by the
  channel estimate, not by power control). The CPU simply adds up all APs'
  contributions. So the mean effective channel is:

                  M                           M
  E{r_{u,k}} = Î£  E{Ä*_{mk} Â· g_{mk}} = Î£  Î³_{mk}
                 m=1                         m=1

  No power control coefficient appears here â€” p_k only scales the overall
  signal. That's why the uplink numerator is p_k Â· (Î£_m Î³_{mk})Â².

  In contrast, for the downlink, AP m can independently control how much power
  it allocates to user k via Î·_{mk}, so âˆšÎ·_{mk} appears inside the sum.

  ---
  3.5 Remark 5 â€” Collocated Special Case (Eq. 28)

  With collocated APs and orthogonal pilots (same simplification as Remark 3):

                            Ï_u Â· M Â· p_k Â· Î³_k
  R_{u,k} = logâ‚‚( 1 + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ )                    ... (28)
                        Ï_u Â· Î£_{k'} p_{k'} Â· Î²_{k'} + 1

  This matches the classical collocated Massive MIMO uplink rate from Ngo et al.
   [21] and Hoydis et al. [36].

  ---
  CHUNK 4: Key Insights, Physical Interpretation & Summary

  4.1 The Big Picture â€” What Section III Tells Us

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                   PERFORMANCE HIERARCHY                          â”‚
  â”‚                                                                  â”‚
  â”‚   M â†’ âˆ, orthogonal pilots:  SINR â†’ âˆ  (unlimited rate)        â”‚
  â”‚          â†‘ noise + all interference vanish                       â”‚
  â”‚                                                                  â”‚
  â”‚   M â†’ âˆ, reused pilots:     SINR â†’ finite  (rate ceiling)       â”‚
  â”‚          â†‘ only pilot contamination remains                      â”‚
  â”‚                                                                  â”‚
  â”‚   Finite M, optimized:      SINR = Theorem 1 or 2               â”‚
  â”‚          â†‘ all impairments present, but quantified               â”‚
  â”‚                                                                  â”‚
  â”‚   Finite M, no optimization: worst performance                   â”‚
  â”‚          â†‘ power control and pilot assignment matter hugely       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  4.2 Why Î³_{mk} Is the Most Important Quantity

  The quantity Î³_{mk} = E{|Ä_{mk}|Â²} = Ï„_pÂ·Ï_pÂ·Î²Â²_{mk} / (Ï„_pÂ·Ï_pÂ·Î£_{k'âˆˆğ’«k} 
  Î²{mk'} + 1) appears everywhere:

  - In the numerator of both DL and UL SINR
  - In the power constraint
  - In the interference terms
  - In the definition of c_{mk}

  Î³_{mk} captures the quality of channel estimation between AP m and user k. It
  depends on:
  - Î²_{mk}: how strong the channel is (distance-dependent)
  - Î£_{k'âˆˆğ’«k} Î²{mk'}: how much pilot contamination there is (other users on the
  same pilot)
  - Ï„_pÂ·Ï_p: training resources (pilot length Ã— pilot power)

  Good estimation (large Î³_{mk}) when:
  - User k is close to AP m (large Î²_{mk})
  - Few co-pilot users are near AP m (small contamination)
  - Plenty of training resources

  ---
  4.3 The Three Impairments â€” A Summary Table

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”
  â”‚     Impairment       â”‚   Physical cause   â”‚ Scales with M  â”‚     Can be
  fixed?    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Beamforming          â”‚ Imperfect channel  â”‚ O(M) â€” drowned â”‚ Improves with
  better â”‚
  â”‚ uncertainty (BU)     â”‚ estimation         â”‚ out by signal  â”‚ estimation
  (more Ï„_p)â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Non-coherent         â”‚ Multi-user         â”‚ O(M) â€” drowned â”‚ Vanishes as M â†’
   âˆ   â”‚
  â”‚ interference         â”‚ interference       â”‚ out by signal  â”‚ (favorable
  propagationâ”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Coherent (pilot      â”‚ Pilot reuse        â”‚ O(MÂ²) â€” same   â”‚ Can be reduced
  by    â”‚
  â”‚ contamination)       â”‚                    â”‚ rate as signal â”‚ pilot
  assignment, NOT â”‚
  â”‚                      â”‚                    â”‚                â”‚ eliminated with
   MF/CB â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Thermal noise        â”‚ Physics            â”‚ O(1) â€” negligibleâ”‚ Overwhelmed
  by array â”‚
  â”‚                      â”‚                    â”‚ for large M    â”‚ gain
         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”˜

  ---
  4.4 Figure 2 â€” Channel Hardening Confirmation

      Rate
      (b/s/Hz)
       â”‚
     8 â”¤                                     ___________  â† K=10, genie-aided
  (Eq.26)
       â”‚                                 ___/
     7 â”¤                              __/ ____________    â† K=10, statistics
  only (Eq.24)
       â”‚                           __/ __/
     6 â”¤                         _/ __/
       â”‚                       _/ _/       small gap â†’ hardening works!
     5 â”¤                     _/ _/
       â”‚                   _/ _/      ___________  â† K=20, genie-aided
     4 â”¤                 _/ _/    ___/
       â”‚               _/ _/  ___/ ___________    â† K=20, statistics only
     3 â”¤             _/ _/ __/ __/
       â”‚           _/ _/__/ __/
     2 â”¤         _/ _/_/ __/
       â”‚       _/_/_/ __/
     1 â”¤    __/__/ __/
       â”‚ __/__/ __/
     0 â”¤â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â†’ M (number of APs)
       0  50 100 150 200 250 300 350 400

  The two curves (genie-aided vs. statistics-only) are very close, confirming
  that:
  1. Channel hardening makes the effective channel nearly deterministic
  2. Downlink pilots are unnecessary
  3. The UatF bound (Eq. 24) is tight in practice

  ---
  4.5 What We'll Implement from Section III

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚          Function                  â”‚          What it computes            â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ compute_gamma(beta, pilot_idx,     â”‚ Î³_{mk} for all m,k from Eq. (8)     â”‚
  â”‚   tau_p, rho_p)                    â”‚                                      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ compute_dl_rate(gamma, beta, eta,  â”‚ R_{d,k} from Theorem 1, Eq. (24)    â”‚
  â”‚   pilot_idx, rho_d)               â”‚                                      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ compute_ul_rate(gamma, beta, p,    â”‚ R_{u,k} from Theorem 2, Eq. (27)    â”‚
  â”‚   pilot_idx, rho_u)               â”‚                                      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ compute_genie_rate(g, g_hat, eta,  â”‚ RÌƒ_{d,k} from Eq. (26) via Monte     â”‚
  â”‚   rho_d)                          â”‚ Carlo                                 â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ plot_hardening_validation(M_range, â”‚ Reproduce Figure 2                   â”‚
  â”‚   K_values)                       â”‚                                       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  4.6 Summary: The Flow from Section II to Section III

  Section II (System Model)              Section III (Performance Analysis)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  Channel: g_{mk} = âˆšÎ²_{mk}Â·h_{mk}  â†’  Asymptotic: as Mâ†’âˆ, only pilot
                                         contamination survives (III-A)

  Estimation: Ä_{mk} = c_{mk}Â·Å·_{mk} â†’ Î³_{mk} = E{|Ä_{mk}|Â²} feeds into
                                         every rate expression

  DL beamforming: x_m = Î£ âˆšÎ·_{mk}Â·  â†’  Theorem 1 (Eq. 24): closed-form
    Ä*_{mk}Â·q_k                         DL rate for any M,K

  UL matched filter: rÌ‚_{mk} =        â†’  Theorem 2 (Eq. 27): closed-form
    Ä*_{mk}Â·y_{u,m}                     UL rate for any M,K

                                         Both use UatF bound + worst-case
                                         Gaussian noise argument

  ---
  This completes the deep dive into Section III. The rate expressions (Eqs. 24
  and 27) are the formulas we'll code in MATLAB â€” they depend only on the
  large-scale fading coefficients Î²_{mk}, power control coefficients, and pilot
  assignments. Section IV (next) will show how to optimize the power control and
   pilot assignment to maximize these rates. Ready to proceed?

âœ» Brewed for 17m 34s

â¯ /export paper analysis\Cell-Free Massive MIMO Versus Small 
Cells\understanding_paper_sec2.txt 
  â¿  Conversation exported to: paper analysis\Cell-Free Massive MIMO Versus
     Small Cells\understanding_paper_sec2.txt

â¯ /export paper analysis\Cell-Free Massive MIMO Versus Small 
Cells\understanding_paper_sec3.txt 
  â¿  Conversation exported to: paper analysis\Cell-Free Massive MIMO Versus
     Small Cells\understanding_paper_sec3.txt

â¯ Yes, proceed to section IV. 

â— Let me extract Section IV from the paper and do thorough research before
  writing the deep dive.

â— 2 Agent agents finished (ctrl+o to expand)
   â”œâ”€ Extract Section IV from paper Â· 22 tool uses Â· 42.2k tokens
   â”‚  â¿ Â Done
   â””â”€ Research power control and pilots Â· 53 tool uses Â· 70.5k tokens
      â¿ Â Done

â— Now I have all the paper content and deep research. Here's the complete deep
  dive.

  ---
  SECTION IV: PILOT ASSIGNMENT AND POWER CONTROL â€” Complete Deep Dive

  ---
  CHUNK 1: The High-Level Picture & Why We Need Resource Management

  1.1 What This Section Is About (Simple Terms)

  Sections II and III built the system and derived rate formulas. But those
  formulas have free parameters â€” which pilot does each user get? and how much 
  power does each AP/user spend? Section IV answers both:

  - IV-A: A greedy algorithm that intelligently assigns pilots to minimize
  contamination
  - IV-B: Max-min power control that ensures every user â€” no matter where they
  are â€” gets a fair share

  Think of it like a classroom. The "channel" is like each student's ability to
  hear the teacher. Some students sit close (strong channel), some sit far (weak
   channel). Section IV is the teacher adjusting volume (power control) and
  making sure students with similar names don't sit together (pilot assignment),
   so everyone can follow the lesson.

  Key insight from the paper: Pilot assignment and power control can be
  performed independently, because the pilots are not power controlled (pilot
  power is fixed). This decouples two otherwise entangled problems.

  ---
  1.2 Why Max-Min Fairness?

  The paper's objective is not to maximize total throughput. Instead, it
  maximizes the minimum user rate â€” the rate of the worst-off user. Why?

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                                      â”‚
  â”‚   Sum-Rate Maximization:     Max-Min Fairness:                       â”‚
  â”‚                                                                      â”‚
  â”‚   User 1: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 50    User 1: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 14                    â”‚
  â”‚   User 2: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40        User 2: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 14                    â”‚
  â”‚   User 3: â–ˆ 2                User 3: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 14                    â”‚
  â”‚   User 4: â–ˆ 1                User 4: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 14                    â”‚
  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                          â”‚
  â”‚   Total: 93 Mbps             Total: 56 Mbps                         â”‚
  â”‚   95%-likely: 1 Mbps         95%-likely: 14 Mbps                     â”‚
  â”‚                                                                      â”‚
  â”‚   Higher total, but User 4   Lower total, but EVERY user             â”‚
  â”‚   is basically offline       gets guaranteed service                  â”‚
  â”‚                                                                      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Cell-Free Massive MIMO's promise is no cell edges â€” uniformly good service
  everywhere. Max-min fairness is the mathematical embodiment of this promise.
  At the optimum, all users achieve the same rate.

  ---
  1.3 Two-Timescale Architecture â€” When Do These Algorithms Run?

  A crucial practical point: both pilot assignment and power control depend only
   on large-scale fading coefficients Î²_{mk} â€” not on instantaneous channels.

  SLOW TIMESCALE (every ~0.5â€“5 seconds):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â€¢ Estimate Î²_{mk} (from long-term signal averaging)    â”‚
  â”‚  â€¢ Run greedy pilot assignment (Algorithm 1)            â”‚
  â”‚  â€¢ Run max-min power control (Algorithm 2 / LP)         â”‚
  â”‚  â€¢ Distribute Î·_{mk}, p_k, pilot indices to APs/users  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“ ~100â€“1000Ã— less frequent than:
  FAST TIMESCALE (every coherence block, ~1â€“10 ms):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â€¢ Uplink pilot transmission                            â”‚
  â”‚  â€¢ MMSE channel estimation at each AP                   â”‚
  â”‚  â€¢ Beamforming/matched filtering (using pre-computed Î·) â”‚
  â”‚  â€¢ Data transmission                                    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  This makes Cell-Free Massive MIMO practically feasible. The expensive
  optimization runs infrequently; the fast real-time processing is simple (just
  multiply by conjugate).

  ---
  CHUNK 2: Greedy Pilot Assignment (Section IV-A)

  2.1 The Problem

  We have Ï„_p orthogonal pilot sequences and K > Ï„_p users. Each user must be
  assigned one of the Ï„_p pilots. Users sharing a pilot contaminate each other's
   channel estimates.

  The optimal assignment is a combinatorial problem with Ï„_p^K possible
  solutions. For Ï„_p = 10, K = 40: that's 10â´â° combinations â€” utterly infeasible
   to search.

  ---
  2.2 Quantifying Pilot Contamination â€” Equation (29)

  Recall from Section II that the projected pilot signal at AP m for user k is:

  Å·_{p,mk} = âˆš(Ï„_pÂ·Ï_p) Â· g_{mk} + âˆš(Ï„_pÂ·Ï_p) Â· Î£_{k'â‰ k} g_{mk'} Â· Ï†*_{k'}Â·Ï†_k +
   wÌƒ_{p,mk}

  The contamination is the second term. Its variance (averaged over small-scale
  fading) at AP m is:

                    K
  E{|contamination|Â²} = Ï„_p Â· Ï_p Â· Î£  Î²_{mk'} Â· |Ï†*_{k'} Â· Ï†_k|Â²
    ... (29)
                   k'â‰ k

  The factor |Ï†*_{k'} Â· Ï†_k|Â² is either 1 (same pilot) or 0 (different pilot).
  So the contamination power at AP m from co-pilot users is:

  Ï„_p Â· Ï_p Â· Î£_{k' âˆˆ ğ’«_k, k'â‰ k} Î²_{mk'}

  where ğ’«_k = set of users sharing the same pilot as user k.

  Physical meaning: The contamination at AP m is worse when co-pilot users have
  large Î²_{mk'} at that AP â€” i.e., when they are close to AP m. Two users near
  the same AP sharing a pilot is the worst case.

  ---
  2.3 The Pilot Reassignment Criterion â€” Equation (30)

  When reassigning user k*'s pilot, the algorithm picks the pilot that minimizes
   the total contamination summed over all APs:

                       M     K
  Ï†_{k*} = arg min    Î£    Î£   Î²_{mk'} Â· |Ï†*_{k'} Â· Ï†_{k*}|Â²
     ... (30)
            Ï†_{k*}âˆˆS  m=1  k'â‰ k*

  Why sum over all APs? Because contamination affects the channel estimate at
  every AP. Even if user k* is far from AP 1, a co-pilot user k' near AP 1 would
   hurt AP 1's estimate of user k*, which feeds into the rate expression.

  ---
  2.4 Algorithm 1 â€” Step by Step

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ALGORITHM 1: Greedy Pilot Assignment                               â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                                     â”‚
  â”‚  INPUT: Î²_{mk} for all m,k; Ï„_p orthogonal pilots; N iterations    â”‚
  â”‚                                                                     â”‚
  â”‚  Step 1: INITIALIZE                                                 â”‚
  â”‚    Randomly assign each user one of Ï„_p pilots                      â”‚
  â”‚    Set iteration counter n = 1                                      â”‚
  â”‚                                                                     â”‚
  â”‚  Step 2: FIND THE BOTTLENECK USER                                   â”‚
  â”‚    Compute R_{d,k} for all k using Theorem 1 (Eq. 24)              â”‚
  â”‚    k* = arg min_k R_{d,k}    (worst user)            ... (31)      â”‚
  â”‚                                                                     â”‚
  â”‚  Step 3: REASSIGN k*'s PILOT                                       â”‚
  â”‚    For each candidate pilot Ï† âˆˆ S (Ï„_p choices):                   â”‚
  â”‚      Temporarily set Ï†_{k*} = Ï†                                    â”‚
  â”‚      Compute contamination metric (Eq. 30)                          â”‚
  â”‚    Pick the Ï† that gives lowest contamination                       â”‚
  â”‚                                                                     â”‚
  â”‚  Step 4: ITERATE                                                    â”‚
  â”‚    n = n + 1                                                        â”‚
  â”‚    If n > N: STOP. Else: go to Step 2.                             â”‚
  â”‚                                                                     â”‚
  â”‚  OUTPUT: Pilot assignment {Ï†_1, ..., Ï†_K}                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  2.5 Numerical Example â€” Greedy Pilot Assignment

  Setup: M = 6 APs, K = 4 users, Ï„_p = 2 (only 2 orthogonal pilots).

     APâ‚ â—            â— APâ‚‚              â— APâ‚ƒ


          UEâ‚ â—†              UEâ‚‚ â—†


     APâ‚„ â—          â— APâ‚…              â— APâ‚†

          UEâ‚ƒ â—†              UEâ‚„ â—†

  Large-scale fading (simplified, higher = closer):

  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
  â”‚     â”‚ UEâ‚  â”‚ UEâ‚‚  â”‚ UEâ‚ƒ  â”‚ UEâ‚„  â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
  â”‚ APâ‚ â”‚ 0.8  â”‚ 0.1  â”‚ 0.3  â”‚ 0.05 â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
  â”‚ APâ‚‚ â”‚ 0.2  â”‚ 0.7  â”‚ 0.1  â”‚ 0.2  â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
  â”‚ APâ‚ƒ â”‚ 0.05 â”‚ 0.3  â”‚ 0.05 â”‚ 0.6  â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
  â”‚ APâ‚„ â”‚ 0.4  â”‚ 0.05 â”‚ 0.9  â”‚ 0.1  â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
  â”‚ APâ‚… â”‚ 0.1  â”‚ 0.3  â”‚ 0.2  â”‚ 0.4  â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
  â”‚ APâ‚† â”‚ 0.05 â”‚ 0.1  â”‚ 0.1  â”‚ 0.5  â”‚
  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜

  Iteration 0 (Random): Assign UEâ‚â†’pilot 1, UEâ‚‚â†’pilot 1, UEâ‚ƒâ†’pilot 2, UEâ‚„â†’pilot
  2.

  Contamination for UEâ‚ (shares pilot 1 with UEâ‚‚):
  Î£_m Î²_{m,2} = 0.1 + 0.7 + 0.3 + 0.05 + 0.3 + 0.1 = 1.55

  Contamination for UEâ‚ƒ (shares pilot 2 with UEâ‚„):
  Î£_m Î²_{m,4} = 0.05 + 0.2 + 0.6 + 0.1 + 0.4 + 0.5 = 1.85

  UEâ‚ƒ and UEâ‚„ share a pilot and are both strong at APâ‚ƒ, APâ‚…, APâ‚† â€” heavy
  contamination! This is bad.

  Iteration 1: Suppose UEâ‚ƒ has the lowest rate â†’ k* = 3.

  Try pilot 1 for UEâ‚ƒ: co-pilot users = {UEâ‚, UEâ‚‚}. Contamination = Î£_m (Î²_{m,1}
   + Î²_{m,2})
  = (0.8+0.1) + (0.2+0.7) + (0.05+0.3) + (0.4+0.05) + (0.1+0.3) + (0.05+0.1) =
  3.15

  Try pilot 2 for UEâ‚ƒ: co-pilot user = {UEâ‚„}. Contamination = Î£_m Î²_{m,4}
  = 0.05 + 0.2 + 0.6 + 0.1 + 0.4 + 0.5 = 1.85

  Pilot 2 gives lower contamination (1.85 < 3.15), so UEâ‚ƒ stays on pilot 2.

  But wait â€” the algorithm might next reassign UEâ‚„ to pilot 1 instead, giving:
  - UEâ‚â†’1, UEâ‚‚â†’1, UEâ‚ƒâ†’2, UEâ‚„â†’1

  Now UEâ‚ƒ has no co-pilot users! UEâ‚ƒ's contamination = 0. UEâ‚„ shares with UEâ‚
  and UEâ‚‚, but UEâ‚ and UEâ‚‚ are spatially far from UEâ‚„. The key: users that are 
  far apart can safely share pilots.

  ---
  2.6 Remark 6 â€” Practical Aspects

  From the paper:
  - The algorithm runs at the CPU (centralized)
  - Runs on the large-scale fading timescale (every few seconds, not
  milliseconds)
  - At 100 km/h mobility, large-scale fading changes ~40Ã— slower than
  small-scale fading â†’ a few updates per second suffice
  - Only an index (logâ‚‚(Ï„_p) bits) needs to be sent to each user to inform their
   pilot assignment

  ---
  CHUNK 3: Downlink Max-Min Power Control (Section IV-B1)

  3.1 The High-Level Picture

  We want to find MÃ—K power coefficients Î·_{mk} (how much power AP m allocates
  to user k) such that the worst user's rate is maximized, subject to each AP
  not exceeding its power budget.

  Imagine 100 flashlights (APs) shining at 40 targets (users).

  Each flashlight can adjust its brightness toward each target independently.

  Goal: Make the DIMMEST target as bright as possible.

  Constraint: Each flashlight has a total brightness budget.

  ---
  3.2 The Optimization Problem â€” Equation (32)

  Formally:

  max         min    R_{d,k}
  {Î·_{mk}}   k=1,...,K

  subject to:
     K
     Î£  Î·_{mk} Â· Î³_{mk} â‰¤ 1     for all m = 1, ..., M     (per-AP power)
    k=1

     Î·_{mk} â‰¥ 0                   for all m, k

  where R_{d,k} is the closed-form rate from Theorem 1 (Eq. 24).

  This is a max-min optimization over MÃ—K variables with M+MÃ—K constraints. The
  objective (min of K rates) is not concave in Î·_{mk} due to the fractional SINR
   structure. Standard convex optimization doesn't apply directly.

  ---
  3.3 Variable Substitution â€” Equation (33)

  The paper introduces Î¼_{mk} = âˆšÎ·_{mk} (square root substitution). This is
  critical because the numerator of Eq. (24) has âˆšÎ·_{mk} inside the sum:

  Numerator = Ï_d Â· ( Î£_m âˆšÎ·_{mk} Â· Î³_{mk} )Â² = Ï_d Â· ( Î£_m Î¼_{mk} Â· Î³_{mk} )Â²

  With this substitution, the problem becomes (33):

                               ( Î£_m Î¼_{mk} Â· Î³_{mk} )Â²
  max   min   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {Î¼_{mk}} k   Î£_{k'â‰ k} |Ï†*_kÂ·Ï†_{k'}|Â² Â· (Î£_m Î¼_{mk'}Â·c_{mk'}Â·Î²_{mk})Â²
                + Î£_m Î£_{k'} Î¼Â²_{mk'} Â· Î³_{mk'} Â· Î²_{mk}  +  1/Ï_d

  subject to:  Î£_k Î¼Â²_{mk} Â· Î³_{mk} â‰¤ 1,  âˆ€m;    Î¼_{mk} â‰¥ 0

  ---
  3.4 Slack Variable Reformulation â€” Equation (34)

  To expose the structure, the paper introduces slack variables:
  - Î½_{kk'}: upper bound on the coherent interference from user k' to user k
  - Ïƒ_m: upper bound on the total power at AP m

  This yields (34) â€” a problem whose objective is shown to be quasi-concave.

  ---
  3.5 What is Quasi-Concavity and Why It Matters

  A function f(x) is quasi-concave if all its superlevel sets are convex:

  {x : f(x) â‰¥ t}  is convex for every t

  Every concave function is quasi-concave, but quasi-concavity is weaker. A
  ratio of concave/convex functions is often quasi-concave even when not
  concave.

  Why it matters: If f is quasi-concave, then for any target value t, checking
  whether f(x) â‰¥ t is achievable is a convex feasibility problem. This enables
  bisection.

  ---
  3.6 Proposition 1 â€” The Key Structural Result

  Proposition 1: The objective function of (34) is quasi-concave.

  Proof sketch (Appendix B):

  The objective is f(S) = min_k SINR_k(S). For a fixed target t, the superlevel
  set is:

  U(f, t) = {S : SINR_k(S) â‰¥ t, âˆ€k}

  Each constraint SINR_k â‰¥ t can be rewritten as:

  Î£_m Î¼_{mk} Â· Î³_{mk}  â‰¥  âˆšt Â· â€–v_kâ€–â‚‚

  where v_k is a vector containing the interference and noise terms. This is a
  second-order cone (SOC) constraint â€” the norm of a vector is bounded by a
  linear function. SOC constraints define convex sets. The intersection of
  convex sets is convex. Therefore U(f, t) is convex â†’ f is quasi-concave. âˆ

  ---
  3.7 Algorithm 2 â€” Bisection + SOCP

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ALGORITHM 2: Bisection for Downlink Max-Min Power Control          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                                     â”‚
  â”‚  INPUT: Î²_{mk}, Î³_{mk}, pilot assignment, tolerance Îµ              â”‚
  â”‚                                                                     â”‚
  â”‚  Step 1: INITIALIZE                                                 â”‚
  â”‚    t_min = 0  (certainly achievable â€” zero rate)                    â”‚
  â”‚    t_max = logâ‚‚(1 + Ï_dÂ·MÂ·max_k Î³_{mk})  (generous upper bound)   â”‚
  â”‚                                                                     â”‚
  â”‚  Step 2: BISECT                                                     â”‚
  â”‚    t = (t_min + t_max) / 2                                         â”‚
  â”‚                                                                     â”‚
  â”‚    Solve the SOCP feasibility problem (Eq. 35):                     â”‚
  â”‚    "Do there exist Î¼_{mk} â‰¥ 0, Î½_{kk'}, Ïƒ_m such that:            â”‚
  â”‚      â€–v_kâ€– â‰¤ (1/âˆšt) Â· Î£_m Î¼_{mk}Â·Î³_{mk}     âˆ€k                  â”‚
  â”‚      Î£_k Î¼Â²_{mk}Â·Î³_{mk} â‰¤ ÏƒÂ²_m               âˆ€m                  â”‚
  â”‚      Î£_m Î¼_{mk'}Â·c_{mk'}Â·Î²_{mk}/âˆšÎ³_{mk'} â‰¤ Î½_{kk'}   âˆ€k'â‰ k     â”‚
  â”‚      0 â‰¤ Ïƒ_m â‰¤ 1                               âˆ€m                  â”‚
  â”‚      Î¼_{mk} â‰¥ 0                                 âˆ€m,k"              â”‚
  â”‚                                                                     â”‚
  â”‚  Step 3: UPDATE BOUNDS                                              â”‚
  â”‚    If FEASIBLE:  t_min = t  (we can achieve this rate)              â”‚
  â”‚    If INFEASIBLE: t_max = t  (this rate is too high)                â”‚
  â”‚                                                                     â”‚
  â”‚  Step 4: CHECK CONVERGENCE                                          â”‚
  â”‚    If t_max âˆ’ t_min < Îµ: STOP, return t and the Î¼_{mk} values      â”‚
  â”‚    Else: go to Step 2                                               â”‚
  â”‚                                                                     â”‚
  â”‚  OUTPUT: Optimal Î·_{mk} = Î¼Â²_{mk}, optimal min-rate t*             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Convergence: The bisection requires âŒˆlogâ‚‚((t_max âˆ’ t_min)/Îµ)âŒ‰ iterations. For
  a rate range of [0, 10] b/s/Hz and Îµ = 0.001, that's ~14 iterations. Each
  iteration solves one SOCP â€” a polynomial-time convex optimization.

  ---
  3.8 The SOCP Feasibility Problem â€” Equation (35) Decoded

  The core constraint is a second-order cone:

  â€–v_kâ€–â‚‚ â‰¤ (1/âˆšt) Â· Î£_m Î¼_{mk} Â· Î³_{mk}

  where v_k stacks all interference and noise terms:

  v_k = [ Ï†*â‚Â·Ï†_k Â· Î½_{1k}, ..., Ï†*_KÂ·Ï†_k Â· Î½_{Kk}  (without k-th),
          Ïƒâ‚Â·âˆšÎ³_{1k}, ..., Ïƒ_MÂ·âˆšÎ³_{Mk},
          1/âˆšÏ_d ]áµ€

  Expanding â€–v_kâ€–Â²:

  â€–v_kâ€–Â² = Î£_{k'â‰ k} |Ï†*_{k'}Â·Ï†_k|Â² Â· Î½Â²_{k'k}  +  Î£_m ÏƒÂ²_m Â· Î³_{mk}  +  1/Ï_d

  This is exactly the denominator of SINR_k! So the constraint â€–v_kâ€– â‰¤ RHS
  means:

  âˆš(denominator of SINR_k)  â‰¤  (1/âˆšt) Â· (numerator of âˆšSINR_k)

  Squaring both sides: SINR_k â‰¥ t. âœ“

  ---
  3.9 Numerical Intuition â€” Why SOCP and Not LP?

  The downlink has MÃ—K power variables Î·_{mk}. The SINR numerator is:

  ( Î£_m âˆšÎ·_{mk} Â· Î³_{mk} )Â²

  The square root of Î·_{mk} inside the sum creates a nonlinear coupling. After
  the substitution Î¼_{mk} = âˆšÎ·_{mk}, the per-AP power constraint becomes:

  Î£_k Î¼Â²_{mk} Â· Î³_{mk} â‰¤ 1     â† quadratic in Î¼_{mk}

  This quadratic constraint is a SOC constraint: â€–[âˆšÎ³_{1k}Â·Î¼_{m1}, ...,
  âˆšÎ³_{Mk}Â·Î¼_{mK}]â€– â‰¤ 1.

  In contrast, the uplink has only K variables p_k with linear constraints â€” no
  square roots, no norms.

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  LP âŠ‚ SOCP âŠ‚ SDP                                â”‚
  â”‚                                                   â”‚
  â”‚  Uplink: linear constraints â†’ LP                  â”‚
  â”‚  Downlink: norm constraints â†’ SOCP                â”‚
  â”‚  (Both solved in polynomial time by interior      â”‚
  â”‚   point methods)                                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  CHUNK 4: Uplink Max-Min Power Control (Section IV-B2) & Summary

  4.1 The Uplink Problem â€” Equation (36)

  The uplink power control is simpler. Each user k has one power coefficient p_k
   âˆˆ [0, 1]:

  max     min    R_{u,k}
  {p_k}   k=1,...,K

  subject to:  0 â‰¤ p_k â‰¤ 1,    k = 1, ..., K                             ...
  (36)

  where R_{u,k} is from Theorem 2 (Eq. 27).

  ---
  4.2 Why the Uplink Is a Linear Problem

  The uplink SINR from Eq. (27) has the structure:

                       Ï_u Â· p_k Â· a_k
  SINR_k = â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            Ï_u Â· Î£_{k'â‰ k} p_{k'} Â· b_{kk'} + c_k

  where:
  - a_k = (Î£_m Î³_{mk})Â² â€” depends only on Î²_{mk} (constant for given pilot
  assignment)
  - b_{kk'} = |Ï†*kÂ·Ï†{k'}|Â² Â· (Î£_m Î³_{mk}Â·Î²_{mk'}/Î³_{mk'})Â² + Î£_m Î³_{mk}Â·Î²_{mk'}
  â€” constant
  - c_k = Î£_m Î³_{mk} â€” constant

  Everything except p_k and p_{k'} is a constant! The SINR is a ratio of linear 
  functions in the power variables.

  After bisection fixes a target SINR_target = 2^t âˆ’ 1, the constraint SINR_k â‰¥
  SINR_target becomes:

  Ï_u Â· p_k Â· a_k  â‰¥  SINR_target Â· (Ï_u Â· Î£_{k'â‰ k} p_{k'} Â· b_{kk'} + c_k)

  Rearranging:

  p_k Â· a_k  âˆ’  SINR_target Â· Î£_{k'â‰ k} p_{k'} Â· b_{kk'}/a_k  â‰¥  SINR_target Â·
  c_k/(Ï_uÂ·a_k)

  This is a linear inequality in {p_1, ..., p_K}. Combined with 0 â‰¤ p_k â‰¤ 1, the
   entire feasibility check is a linear program (LP).

  ---
  4.3 Proposition 2 â€” Quasi-Linearity

  Proposition 2: The optimization problem (37) is quasi-linear.

  A function is quasi-linear if it is both quasi-concave and quasi-convex. For
  the uplink SINR, this means both the superlevel sets {p : SINR_k â‰¥ t, âˆ€k} and
  sublevel sets {p : SINR_k â‰¤ t, âˆ€k} are convex (in fact, polyhedral â€” defined
  by linear inequalities). This is because the SINR is a ratio of linear
  functions in p.

  ---
  4.4 The Bisection Algorithm for Uplink

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  UPLINK MAX-MIN POWER CONTROL (Bisection + LP)                      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                                     â”‚
  â”‚  Step 1: Set t_min = 0, t_max = generous upper bound               â”‚
  â”‚                                                                     â”‚
  â”‚  Step 2: t = (t_min + t_max) / 2                                   â”‚
  â”‚    Solve the LP feasibility:                                        â”‚
  â”‚    "Do there exist p_1,...,p_K such that:                           â”‚
  â”‚      p_k Â· a_k âˆ’ (2^tâˆ’1) Â· Î£_{k'â‰ k} p_{k'} Â· b_{kk'} â‰¥ (2^tâˆ’1)Â·c_k/Ï_u   âˆ€kâ”‚
  â”‚      0 â‰¤ p_k â‰¤ 1                                         âˆ€k"      â”‚
  â”‚                                                                     â”‚
  â”‚  Step 3: If FEASIBLE: t_min = t. If INFEASIBLE: t_max = t.        â”‚
  â”‚                                                                     â”‚
  â”‚  Step 4: If t_max âˆ’ t_min < Îµ: STOP. Else: go to Step 2.         â”‚
  â”‚                                                                     â”‚
  â”‚  OUTPUT: Optimal p_k for all k, optimal min-rate t*                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  LP is much faster than SOCP. For K = 40 users, the LP has 40 variables and ~80
   constraints â€” solved in microseconds.

  ---
  4.5 Complete Comparison: Downlink vs. Uplink Power Control

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚       Aspect          â”‚      Downlink (IV-B1)    â”‚     Uplink (IV-B2)      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Variables             â”‚ Î·_{mk} (MÃ—K)             â”‚ p_k (K)                 â”‚
  â”‚                       â”‚ = 100Ã—40 = 4000          â”‚ = 40                    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Constraints           â”‚ Per-AP: Î£_k Î·_{mk}Î³_{mk}â”‚ Per-user: 0 â‰¤ p_k â‰¤ 1  â”‚
  â”‚                       â”‚ â‰¤ 1  (M constraints)     â”‚ (K constraints)         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ SINR structure        â”‚ Ratio with âˆšÎ·_{mk}      â”‚ Ratio linear in p_k     â”‚
  â”‚                       â”‚ inside sum (nonlinear)   â”‚ (linear/linear)         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Structural property   â”‚ Quasi-concave            â”‚ Quasi-linear            â”‚
  â”‚                       â”‚ (Proposition 1)          â”‚ (Proposition 2)         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Outer search          â”‚ Bisection on rate t      â”‚ Bisection on rate t     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Inner feasibility     â”‚ SOCP (norm constraints)  â”‚ LP (linear constraints) â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Solver                â”‚ CVX + SeDuMi/MOSEK       â”‚ CVX + linprog           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Iterations            â”‚ ~10â€“15                   â”‚ ~10â€“15                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Per-iteration cost    â”‚ O(âˆš(M+K) Â· (MK)Â³)       â”‚ O(KÂ³)                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Practical time        â”‚ Seconds to minutes       â”‚ Milliseconds            â”‚
  â”‚ (M=100, K=40)        â”‚                          â”‚                         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Optimality            â”‚ Global (quasi-concave    â”‚ Global (quasi-linear    â”‚
  â”‚                       â”‚ + bisection)             â”‚ + bisection)            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  4.6 Why This Achieves Uniformly Good Service

  At the optimum of the max-min problem, all users achieve the same rate. Here's
   why:

  Suppose at the optimum, user 1 has rate Râ‚ = 5 and user 2 has rate Râ‚‚ = 7
  (with Râ‚ being the minimum). Then we could reduce the power spent on user 2
  and redistribute it to user 1, improving Râ‚ beyond 5 â€” contradicting the
  assumption that Râ‚ = 5 is optimal. Therefore, at the true optimum, Râ‚ = Râ‚‚ =
  ... = R_K.

  Before max-min power control:           After max-min power control:

  Rate                                    Rate
  â”‚                                       â”‚
  â”‚ â–ˆâ–ˆâ–ˆ                                   â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
  â”‚ â–ˆâ–ˆâ–ˆ                                   â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
  â”‚ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ                              â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
  â”‚ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                      â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
  â”‚ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ           â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
  â”‚ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ           â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
  â””â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€           â””â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€
    UEâ‚ UEâ‚‚  UEâ‚ƒ   UEâ‚„                    UEâ‚ UEâ‚‚  UEâ‚ƒ   UEâ‚„

  95%-likely â‰ˆ 3 Mbps                     95%-likely â‰ˆ 14 Mbps

  ---
  4.7 Remark 7 â€” Weighted Max-Min Fairness

  The framework generalizes to weighted max-min:

  max   min  {w_k Â· R_k}

  where w_k > 0 is a priority weight. A user with higher priority gets a smaller
   w_k, so the algorithm works harder to give them a higher rate. This allows
  the operator to differentiate service classes while maintaining fairness.

  ---
  4.8 The Complete Resource Management Flow

                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚  Large-scale fading  â”‚
                      â”‚  Î²_{mk} (measured)   â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â–¼                â”‚                â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  ALGORITHM 1:     â”‚       â”‚    â”‚  Need pilot assignment â”‚
     â”‚  Greedy Pilot     â”‚       â”‚    â”‚  FIRST, because Î³_{mk} â”‚
     â”‚  Assignment       â”‚       â”‚    â”‚  depends on it         â”‚
     â”‚                   â”‚       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚  Output:          â”‚       â”‚
     â”‚  pilot_idx(k)     â”‚       â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
              â”‚                  â”‚
              â–¼                  â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
     â”‚  Compute Î³_{mk}  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚  from Î²_{mk} and â”‚
     â”‚  pilot_idx        â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
       â–¼              â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ALGO 2:  â”‚  â”‚ UPLINK:  â”‚
  â”‚ DL Power â”‚  â”‚ Bisectionâ”‚
  â”‚ Control  â”‚  â”‚ + LP     â”‚
  â”‚ (SOCP)   â”‚  â”‚          â”‚
  â”‚          â”‚  â”‚ Output:  â”‚
  â”‚ Output:  â”‚  â”‚ p_k      â”‚
  â”‚ Î·_{mk}   â”‚  â”‚          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚              â”‚
       â–¼              â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Distribute to APs and users:   â”‚
  â”‚  - Pilot indices                â”‚
  â”‚  - DL power coefficients Î·_{mk} â”‚
  â”‚  - UL power coefficients p_k    â”‚
  â”‚                                 â”‚
  â”‚  (All via backhaul, infrequently)â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  4.9 Key Results from Numerical Experiments (Preview of Section VI)

  The paper's simulations show the impact of pilot assignment and power control:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚         Configuration                 â”‚  95%-likely DL rate  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Random pilots + no power control      â”‚   ~2 Mbps            â”‚
  â”‚ Random pilots + max-min power control â”‚   ~12 Mbps           â”‚
  â”‚ Greedy pilots + max-min power control â”‚   ~14 Mbps           â”‚
  â”‚ Small cells + max-min power control   â”‚   ~2â€“3 Mbps          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Power control provides a ~6Ã— improvement (2 â†’ 12 Mbps).
  Greedy pilot assignment adds another ~20% gain (12 â†’ 14 Mbps).
  Cell-Free vs. small cells: ~5â€“7Ã— improvement.

  The takeaway: Power control is far more important than pilot assignment for
  Cell-Free Massive MIMO. But both together give the best performance.

  ---
  4.10 What We'll Implement from Section IV

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”
  â”‚           Function               â”‚            What it implements
   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”¤
  â”‚ greedy_pilot_assignment(         â”‚ Algorithm 1: iterative pilot reassignment
   â”‚
  â”‚   beta, tau_p, N_iter)           â”‚ minimizing contamination metric (Eq.30)
  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”¤
  â”‚ dl_maxmin_power_control(         â”‚ Algorithm 2: bisection + SOCP (Eq.35)
  â”‚
  â”‚   gamma, beta, c, pilot_idx,    â”‚ using CVX in MATLAB                      â”‚
  â”‚   rho_d, epsilon)               â”‚ Returns Î·_{mk}                           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”¤
  â”‚ ul_maxmin_power_control(         â”‚ Bisection + LP (Prop. 2)
  â”‚
  â”‚   gamma, beta, pilot_idx,       â”‚ using CVX or linprog                     â”‚
  â”‚   rho_u, epsilon)               â”‚ Returns p_k                              â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”¤
  â”‚ compute_contamination_metric(    â”‚ Eq. (30): total contamination for a
  â”‚
  â”‚   beta, gamma, pilot_idx, k)    â”‚ given pilot assignment of user k         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”˜

  ---
  This completes the deep dive into Section IV. We now have the full pipeline:
  system model (II), rate analysis (III), and resource optimization (IV).
  Section V defines the small-cell baseline for comparison, and Section VI puts
  it all together with simulations. Ready to proceed to Section V?

âœ» SautÃ©ed for 9m 22s

â¯ /export paper analysis\Cell-Free Massive MIMO Versus Small 
Cells\understanding_paper_sec4.txt 
  â¿  Conversation exported to: paper analysis\Cell-Free Massive MIMO Versus
     Small Cells\understanding_paper_sec4.txt

â¯ Now, proceed to section 5. 

â— Let me extract Section V from the paper and do thorough research.

â— 2 Agent agents finished (ctrl+o to expand)
   â”œâ”€ Extract Section V from paper Â· 10 tool uses Â· 21.2k tokens
   â”‚  â¿ Â Done
   â””â”€ Research small-cell baseline systems Â· 78 tool uses Â· 73.3k tokens
      â¿ Â Done

â— Now I have all the paper content and deep research. Here's the complete deep
  dive.

  ---
  SECTION V: SMALL-CELL SYSTEM (Baseline) â€” Complete Deep Dive

  ---
  CHUNK 1: The High-Level Picture & System Architecture

  1.1 What This Section Is About (Simple Terms)

  Sections IIâ€“IV built the Cell-Free Massive MIMO system. But how do we know
  it's actually good? We need a baseline to compare against. Section V defines
  that baseline: a small-cell system â€” the simplest possible way to use the same
   M APs and K users.

  In small cells, each user picks one AP (the best one) and talks only to that
  AP. No cooperation, no coordination between APs. It's like having 100 lamp
  posts in a park, but each person only uses the nearest one â€” the rest are
  wasted (for that person).

    CELL-FREE (Sections IIâ€“IV):               SMALL CELLS (Section V):

    â”Œâ”€â”€â”€â”€â”€â”                                   â”Œâ”€â”€â”€â”€â”€â”
    â”‚ CPU â”‚ â† coordinates everything           â”‚ CPU â”‚ â† minimal role
    â””â”€â”€â”¬â”€â”€â”˜                                   â””â”€â”€â”¬â”€â”€â”˜
       â”‚                                          â”‚
    â”Œâ”€â”€â”¼â”€â”€â”¬â”€â”€â”¬â”€â”€â”                             â”Œâ”€â”€â”¼â”€â”€â”¬â”€â”€â”¬â”€â”€â”
    APâ‚ APâ‚‚ APâ‚ƒ APâ‚„                          APâ‚ APâ‚‚ APâ‚ƒ APâ‚„
    â•²â”‚â•± â•²â”‚â•± â•²â”‚â•± â•²â”‚â•±  â† ALL APs serve          â”‚       â”‚
    UEâ‚ UEâ‚‚ UEâ‚ƒ UEâ‚„    ALL users             UEâ‚     UEâ‚ƒ    â† each user gets
                                                               ONE AP only
                                               APâ‚‚     APâ‚„
                                                â”‚       â”‚
                                               UEâ‚‚     UEâ‚„

  ---
  1.2 Why Small Cells Are the Right Comparison

  The paper uses the same physical infrastructure (M APs, K users, same
  locations, same channels) for both systems. The only difference is the
  operating mode:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                     â”‚        Cell-Free        â”‚       Small Cells       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ APs serving each    â”‚ All M                   â”‚ 1                       â”‚
  â”‚ user                â”‚                         â”‚                         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Cooperation         â”‚ Full (via CPU)          â”‚ None                    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Beamforming         â”‚ Conjugate BF            â”‚ Direct transmission     â”‚
  â”‚                     â”‚ (distributed)           â”‚                         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Channel hardening   â”‚ Yes (sum of M terms)    â”‚ No (single Rayleigh     â”‚
  â”‚                     â”‚                         â”‚ scalar)                 â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Downlink pilots     â”‚ No                      â”‚ Yes                     â”‚
  â”‚ needed              â”‚                         â”‚                         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  This isolates the benefit of cooperation â€” the gains come purely from having
  all APs serve all users, not from better hardware.

  ---
  1.3 AP Selection Rule â€” Equation (38)

  Each user picks the AP with the strongest large-scale fading (i.e., typically
  the closest AP):

  m_k = arg max      Î²_{mk}                                                ...
  (38)
        m âˆˆ {available APs}

  Critical detail: Once an AP is selected by one user, it becomes unavailable
  for others. The selection is done user-by-user in random order. This means:
  - Each AP serves at most one user
  - Some APs may serve no users (if M > K, there are M âˆ’ K idle APs)
  - A user arriving later in the selection order might not get its best AP

  This is a greedy one-to-one assignment â€” not globally optimal, but simple and
  realistic.

  Numerical example: M = 6 APs, K = 4 users.

  Î² values:        APâ‚   APâ‚‚   APâ‚ƒ   APâ‚„   APâ‚…   APâ‚†
    UEâ‚            0.8   0.2   0.05  0.4   0.1   0.05
    UEâ‚‚            0.1   0.7   0.3   0.05  0.3   0.1
    UEâ‚ƒ            0.3   0.1   0.05  0.9   0.2   0.1
    UEâ‚„            0.05  0.2   0.6   0.1   0.4   0.5

  Selection order: UEâ‚‚ first, then UEâ‚ƒ, UEâ‚, UEâ‚„

    UEâ‚‚ picks APâ‚‚ (Î² = 0.7, best)        â†’ APâ‚‚ removed
    UEâ‚ƒ picks APâ‚„ (Î² = 0.9, best)        â†’ APâ‚„ removed
    UEâ‚ picks APâ‚ (Î² = 0.8, best still available) â†’ APâ‚ removed
    UEâ‚„ picks APâ‚ƒ (Î² = 0.6, best remaining)       â†’ APâ‚ƒ removed
    APâ‚…, APâ‚† are idle (serve nobody)

  In Cell-Free, ALL 6 APs serve ALL 4 users. In small cells, each user gets one
  AP and two APs sit idle.

  ---
  1.4 The Fundamental Difference: No Channel Hardening

  This is the single most important conceptual distinction between Cell-Free and
   small cells.

  Cell-Free: The effective channel gain is a sum of M terms:
  a_k = Î£_{m=1}^{M} âˆšÎ·_{mk} Â· g_{mk} Â· Ä*_{mk}
  By the law of large numbers (M large), a_k â‰ˆ E{a_k} = deterministic constant.
  The channel "hardens."

  Small cells: The effective channel is a single complex Gaussian scalar:
  g_{m_k,k} = âˆšÎ²_{m_k,k} Â· h_{m_k,k}     where h_{m_k,k} ~ CN(0,1)

  There is no sum, no averaging, no law of large numbers. The channel gain
  |h_{m_k,k}|Â² ~ Exp(1) fluctuates wildly:

  Channel hardening comparison:

    Cell-Free (M=100 APs):              Small Cell (1 AP):

    Effective |channel|Â²                Effective |channel|Â²
    â”‚                                   â”‚
    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚    â•±â•²
    â”‚     â”‚             â”‚              â”‚   â•±  â•²    â•±â•²
    â”‚â”€â”€â”€â”€â”€â”¤   ~mean     â”œâ”€â”€â”€â”€â”€         â”‚  â•±    â•²â•±â•±  â•²    â•±â•²
    â”‚     â”‚             â”‚              â”‚â•±â•±           â•²â•±â•±  â•²â•±â•²
    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ time           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ time

    Variance/meanÂ² â‰ˆ 1/M_eff â‰ˆ 5%     Variance/meanÂ² = 100% (!!)
    â†’ nearly deterministic              â†’ random, deep fades possible

  Consequence: In small cells, the user must estimate the downlink channel to
  decode. This requires downlink pilots â€” extra overhead that Cell-Free avoids.

  ---
  CHUNK 2: Small-Cell Downlink (Section V-A)

  2.1 Downlink Channel Estimation â€” Equations (39)â€“(40)

  Since the user cannot rely on statistics alone, the AP must send pilot symbols
   so the user can estimate the channel.

  The MMSE estimate of g_{m_k,k} (channel from user k's serving AP):

  g_{m_k,k} = Ä_{m_k,k} + Îµ_{m_k,k}        (true = estimate + error)   ... (39)

  where Ä_{m_k,k} ~ CN(0, Î³Ì‚_{m_k,k}) and Îµ_{m_k,k} ~ CN(0, Î²_{m_k,k} âˆ’
  Î³Ì‚_{m_k,k}).

  The estimation quality is: Eq. (40)

                           Ï„_d^sc Â· Ï_{d,p}^sc Â· Î²Â²_{m_k,k}
  Î³Ì‚_{m_k,k} = â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                Ï„_d^sc Â· Ï_{d,p}^sc Â· Î£_{k'=1}^{K} Î²_{m_k,k'} Â· |Ï†*_{k'}Â·Ï†_k|Â² +
   1

  This looks similar to the Cell-Free Î³_{mk} from Eq. (8), but with two key
  differences:

  1. It uses downlink pilot parameters (Ï„_d^sc, Ï_{d,p}^sc) â€” the user estimates
   the channel from the AP's pilot, not the other way around
  2. The pilot contamination comes from other APs' pilots interfering at the
  user, not other users' pilots at the AP

  ---
  2.2 Received Signal â€” Equation (41)

  The user k receives signals from all K active APs (not just its own), because
  they all transmit on the same frequency:

  y_k = âˆšÏ_d^sc Â· Î£_{k'=1}^{K} g_{m_{k'},k} Â· âˆšÎ·_{d,k'} Â· q_{k'} + w_k       ...
   (41)

  Decomposing into four terms:

  y_k = âˆšÏ_d^sc Â· Ä_{m_k,k} Â· âˆšÎ·_{d,k} Â· q_k          â† desired signal (known
  channel est.)
      + âˆšÏ_d^sc Â· Îµ_{m_k,k} Â· âˆšÎ·_{d,k} Â· q_k            â† estimation error
  self-interference
      + âˆšÏ_d^sc Â· Î£_{k'â‰ k} g_{m_{k'},k} Â· âˆšÎ·_{d,k'} Â· q_{k'}  â† inter-cell
  interference
      + w_k                                                 â† noise

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚     Term      â”‚                    Meaning                        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Term 1        â”‚ Signal through the ESTIMATED channel (useful)     â”‚
  â”‚ Term 2        â”‚ Signal through the ESTIMATION ERROR (harmful)     â”‚
  â”‚ Term 3        â”‚ Interference from OTHER APs serving other users   â”‚
  â”‚ Term 4        â”‚ Thermal noise                                     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Remark 8 (from the paper): In small cells, since only one single-antenna AP
  serves each user, "conjugate beamforming" becomes void. The AP just transmits
  âˆšÎ·_{d,k} Â· q_k directly â€” no spatial processing at all.

  ---
  2.3 Why the Rate Requires an Expectation â€” Equation (42)

  In Cell-Free, the SINR is nearly deterministic (channel hardening), so:
  R_{d,k}^{cf} = logâ‚‚(1 + SINR_k)     (deterministic SINR, no expectation
  needed)

  In small cells, the SINR is random (depends on |Ä_{m_k,k}|Â² which fluctuates).
   The ergodic rate requires averaging over the fading:

  R_d^{sc,k} = E{ logâ‚‚(1 + SINR_k^{random}) }                            ...
  (42)

  where the instantaneous SINR is:

                        Ï_d^sc Â· Î·_{d,k} Â· |Ä_{m_k,k}|Â²
  SINR_k =
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            Ï_d^sc Â· Î·_{d,k} Â· (Î²_{m_k,k} âˆ’ Î³Ì‚_{m_k,k}) + Ï_d^sc Â· Î£_{k'â‰ k}
  Î·_{d,k'} Â· Î²_{m_{k'},k} + 1

  Notice: the numerator contains the random variable |Ä_{m_k,k}|Â², while the
  denominator is deterministic (it contains only large-scale fading
  coefficients). This is because the interference from other APs averages out
  across many coherence intervals â€” only the desired channel to the serving AP
  matters.

  ---
  2.4 The Exponential Integral â€” Equations (43)â€“(44)

  Now comes the mathematical highlight of Section V. Since Ä_{m_k,k} ~ CN(0,
  Î³Ì‚_{m_k,k}), we have:

  |Ä_{m_k,k}|Â² ~ Exponential(1/Î³Ì‚_{m_k,k})     i.e., E{|Ä_{m_k,k}|Â²} = Î³Ì‚_{m_k,k}

  The effective SINR parameter (deterministic part) is: Eq. (44)

                        Ï_d^sc Â· Î·_{d,k} Â· Î³Ì‚_{m_k,k}
  Î³Ìƒ_{m_k,k} = â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                Ï_d^sc Â· Î·_{d,k} Â· (Î²_{m_k,k} âˆ’ Î³Ì‚_{m_k,k}) + Ï_d^sc Â· Î£_{k'â‰ k}
  Î·_{d,k'} Â· Î²_{m_{k'},k} + 1

  So the rate becomes:

  R_d^{sc,k} = E{ logâ‚‚(1 + Î³Ìƒ_{m_k,k} Â· X) }     where X = |Ä_{m_k,k}|Â²/Î³Ì‚_{m_k,k}
   ~ Exp(1)

  This expectation has a beautiful closed form. Let me derive it step by step.

  Derivation of E{logâ‚‚(1 + Î³Â·X)} where X ~ Exp(1):

  R = (1/ln 2) Â· âˆ«â‚€^âˆ ln(1 + Î³x) Â· e^{âˆ’x} dx

  Integration by parts with u = ln(1 + Î³x), dv = e^{âˆ’x}dx:

  R = (1/ln 2) Â· [ âˆ’ln(1+Î³x)Â·e^{âˆ’x} |â‚€^âˆ  +  âˆ«â‚€^âˆ (Î³/(1+Î³x)) Â· e^{âˆ’x} dx ]

    = (1/ln 2) Â· âˆ«â‚€^âˆ Î³Â·e^{âˆ’x}/(1+Î³x) dx

  Substituting t = 1 + Î³x  (so x = (tâˆ’1)/Î³, dx = dt/Î³):

    = (1/ln 2) Â· e^{1/Î³} Â· âˆ«â‚^âˆ e^{âˆ’t/Î³}/t dt

  Substituting u = t/Î³:

    = (1/ln 2) Â· e^{1/Î³} Â· âˆ«_{1/Î³}^âˆ e^{âˆ’u}/u du

  The integral âˆ«_z^âˆ e^{âˆ’u}/u du is the exponential integral Eâ‚(z). The
  relationship to Ei is: Eâ‚(z) = âˆ’Ei(âˆ’z). Therefore:

  R = (1/ln 2) Â· e^{1/Î³} Â· Eâ‚(1/Î³) = âˆ’(logâ‚‚ e) Â· e^{1/Î³} Â· Ei(âˆ’1/Î³)

  This gives us Eq. (43):

  R_d^{sc,k} = âˆ’(logâ‚‚ e) Â· e^{1/Î³Ìƒ_{m_k,k}} Â· Ei(âˆ’1/Î³Ìƒ_{m_k,k})           ... (43)

  Numerical example:

  Let Î³Ìƒ = 5 (â‰ˆ 7 dB SINR parameter).

  R = âˆ’logâ‚‚(e) Â· e^{1/5} Â· Ei(âˆ’1/5)

    = âˆ’1.4427 Â· e^{0.2} Â· Ei(âˆ’0.2)

    = âˆ’1.4427 Â· 1.2214 Â· (âˆ’1.2227)

    â‰ˆ 2.155 b/s/Hz

  Compare with the "no fading" rate: logâ‚‚(1 + 5) = 2.585 b/s/Hz.

  The fading penalty is 2.585 âˆ’ 2.155 = 0.43 b/s/Hz (~17%). Fading always hurts
  â€” the random fluctuations waste capacity compared to a deterministic channel.

  The Ei-based rate vs. no-fading rate:

    Rate (b/s/Hz)
     â”‚
   6 â”¤                                    â•±  â† logâ‚‚(1+Î³) (no fading / Cell-Free)
     â”‚                                  â•±
   5 â”¤                               â•±â•±
     â”‚                            â•±â•±    â•±  â† âˆ’logâ‚‚(e)Â·e^{1/Î³}Â·Ei(âˆ’1/Î³) (Rayleigh
   / small cell)
   4 â”¤                         â•±â•±   â•±â•±
     â”‚                      â•±â•±  â•±â•±
   3 â”¤                   â•±â•±â•±â•±
     â”‚               â•±â•±â•±â•±
   2 â”¤           â•±â•±â•±â•±
     â”‚       â•±â•±â•±â•±          gap = fading penalty
   1 â”¤   â•±â•±â•±â•±             (always positive, grows with Î³)
     â”‚â•±â•±â•±
   0 â”¼â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â†’ Î³ (SINR parameter, linear)
     0  2  4  6  8  10


  ---
  2.5 In MATLAB, This Is Trivially Computed

  % MATLAB: Compute small-cell rate
  R_sc = -(log2(exp(1))) * exp(1./gamma_tilde) .* expint(1./gamma_tilde);

  where expint() is MATLAB's built-in Eâ‚(z) function.

  ---
  CHUNK 3: Small-Cell Uplink (Section V-B) & Power Control (Section V-C)

  3.1 Uplink Rate â€” Equations (47)â€“(49)

  The uplink follows the exact same structure. The AP m_k estimates the uplink
  channel from user k's pilot, then detects user k's symbol. The achievable rate
   has the identical Ei form:

  R_u^{sc,k} = âˆ’(logâ‚‚ e) Â· e^{1/Î³Ì„_{m_k,k}} Â· Ei(âˆ’1/Î³Ì„_{m_k,k})           ... (47)

  where the uplink effective SINR parameter is: Eq. (48)

                        Ï_u^sc Â· Î·_{u,k} Â· Î³_{m_k,k}
  Î³Ì„_{m_k,k} = â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                Ï_u^sc Â· Î·_{u,k} Â· (Î²_{m_k,k} âˆ’ Î³_{m_k,k}) + Ï_u^sc Â· Î£_{k'â‰ k}
  Î·_{u,k'} Â· Î²_{m_k,k'} + 1

  and the uplink channel estimation quality is: Eq. (49)

                           Ï„_u^sc Â· Ï_{u,p}^sc Â· Î²Â²_{m_k,k}
  Î³_{m_k,k} = â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                Ï„_u^sc Â· Ï_{u,p}^sc Â· Î£_{k'=1}^{K} Î²_{m_k,k'} Â· |Ï†*_{k'}Â·Ï†_k|Â² +
   1

  Structural parallel: Both DL and UL rates have the same mathematical form:

  R = âˆ’(logâ‚‚ e) Â· e^{1/Î³_eff} Â· Ei(âˆ’1/Î³_eff)

          Ï Â· Î· Â· (estimation quality)
  Î³_eff = â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          Ï Â· Î· Â· (estimation error) + Ï Â· (interference) + 1

  The only differences:
  - DL uses downlink pilot parameters (Ï„_d^sc, Ï_{d,p}^sc)
  - UL uses uplink pilot parameters (Ï„_u^sc, Ï_{u,p}^sc)
  - DL interference comes from other APs transmitting to their users
  - UL interference comes from other users transmitting to their APs

  ---
  3.2 Training Overhead Comparison

  CELL-FREE coherence interval (Ï„_c = 200):

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  UL pilots â”‚   DL data               â”‚   UL data              â”‚
    â”‚  Ï„_p = 10  â”‚   ~95 symbols           â”‚   ~95 symbols          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    Overhead: 10/200 = 5%    (NO downlink pilots needed!)


  SMALL-CELL coherence interval (Ï„_c = 200):

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  UL pilots â”‚  DL pilots â”‚   DL data       â”‚   UL data       â”‚
    â”‚  Ï„_u^sc    â”‚  Ï„_d^sc    â”‚   ~80 symbols   â”‚   ~80 symbols   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    Overhead: (Ï„_u + Ï„_d)/200 â‰ˆ 10â€“20%    (BOTH directions need pilots!)

  Small cells waste more of the coherence interval on training, leaving fewer
  symbols for data. This is an additional penalty beyond the lack of
  cooperation.

  ---
  3.3 Max-Min Power Control for Small Cells â€” Equations (45)â€“(46), (50)

  Downlink (Eq. 45â€“46):

  max       min     R_d^{sc,k}
  {Î·_{d,k}}  k=1,...,K

  subject to:  0 â‰¤ Î·_{d,k} â‰¤ 1,    k = 1, ..., K                          ...
  (45)

  Since R_d^{sc,k} = âˆ’(logâ‚‚ e) Â· e^{1/Î³Ìƒ} Â· Ei(âˆ’1/Î³Ìƒ) is a monotonically 
  increasing function of Î³Ìƒ_{m_k,k} (higher SINR parameter â†’ higher rate),
  maximizing min-rate is equivalent to maximizing min-SINR-parameter:

  max       min     Î³Ìƒ_{m_k,k}                                              ...
  (46)
  {Î·_{d,k}}  k=1,...,K

  subject to:  0 â‰¤ Î·_{d,k} â‰¤ 1

  This is a quasi-linear program (same structure as the Cell-Free uplink) â€”
  solvable by bisection + LP.

  Why it's simpler than Cell-Free downlink: In small cells, each AP serves
  exactly one user, so there's only K power variables Î·_{d,k} (one per user/AP
  pair), not MÃ—K. And Î³Ìƒ_{m_k,k} is a ratio of linear functions in Î·_{d,k}, so
  the bisection sub-problem is an LP.

  Uplink (Eq. 50): Identical structure:

  max       min     Î³Ì„_{m_k,k}                                              ...
  (50)
  {Î·_{u,k}}  k=1,...,K

  subject to:  0 â‰¤ Î·_{u,k} â‰¤ 1

  Also quasi-linear, also solvable by bisection + LP.

  ---
  CHUNK 4: Fair Comparison Framework & Key Insights

  4.1 How the Paper Makes the Comparison Fair

  The paper is very careful to avoid biasing the comparison. Here's the fairness
   protocol:

  Equal total radiated power:

  In Cell-Free, all M APs transmit with power Ï_d^cf each. Total DL power = M Â·
  Ï_d^cf.

  In small cells, only K APs are active. To equalize total power:

  K Â· Ï_d^sc = M Â· Ï_d^cf

  â†’  Ï_d^sc = (M/K) Â· Ï_d^cf

  With M = 100, K = 40: Ï_d^sc = 2.5 Â· Ï_d^cf. Each small-cell AP gets 2.5Ã— more
   power than each Cell-Free AP. This is generous to small cells.

  Uplink power equalized: Ï_u^sc = Ï_u^cf (users transmit with the same power in
   both systems).

  Same physical setup: Same M AP locations, same K user locations, same channel
  realizations Î²_{mk}. Only the operating mode changes.

  ---
  4.2 Three Ways the Comparison Favors Small Cells

  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  #  â”‚          Advantage               â”‚         Why it's generous  â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  1  â”‚ Small-cell APs get M/K Ã— more    â”‚ Concentrated power at each â”‚
  â”‚     â”‚ transmit power per AP            â”‚ active AP                  â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  2  â”‚ Cell-Free rate uses a lower      â”‚ UatF bound is conservative â”‚
  â”‚     â”‚ bound (UatF / Eq. 24)            â”‚ (treats channel deviation  â”‚
  â”‚     â”‚                                  â”‚ as worst-case noise)       â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  3  â”‚ Small-cell rate uses the ergodic â”‚ Assumes user perfectly     â”‚
  â”‚     â”‚ rate with exact DL CSI (Eq. 42)  â”‚ tracks instantaneous SINR  â”‚
  â”‚     â”‚                                  â”‚ (optimistic for small cell)â”‚
  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Despite all three advantages, Cell-Free Massive MIMO still dominates small
  cells by 5â€“10Ã— at the 95%-likely per-user rate. This makes the paper's
  conclusion very strong.

  ---
  4.3 Complete Side-by-Side Comparison

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”
  â”‚        Aspect            â”‚      Cell-Free           â”‚      Small Cells
      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ APs per user             â”‚ ALL M (cooperative)      â”‚ 1 (non-cooperative)
      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ Active APs               â”‚ M (all transmit)         â”‚ K (Mâˆ’K idle)
      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ Power per AP             â”‚ Ï_d^cf                   â”‚ (M/K)Â·Ï_d^cf (higher!)
     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ Beamforming              â”‚ Conjugate BF (Ä*_{mk})  â”‚ None (direct TX)
     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ Channel hardening        â”‚ Yes (sum of M terms)     â”‚ No (single scalar)
      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ DL pilots needed         â”‚ No                       â”‚ Yes (extra overhead)
      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ Rate formula             â”‚ logâ‚‚(1 + SINR_det)      â”‚
  âˆ’logâ‚‚(e)Â·e^{1/Î³}Â·Ei(âˆ’1/Î³)â”‚
  â”‚                          â”‚ (deterministic SINR)     â”‚ (ergodic, with Ei)
      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ Power control variables  â”‚ DL: MÃ—K (Î·_{mk})        â”‚ DL: K (Î·_{d,k})
     â”‚
  â”‚                          â”‚ UL: K (p_k)             â”‚ UL: K (Î·_{u,k})
     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ DL power control type    â”‚ Bisection + SOCP         â”‚ Bisection + LP
      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ UL power control type    â”‚ Bisection + LP           â”‚ Bisection + LP
      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ Macro-diversity gain     â”‚ Yes (many APs nearby)    â”‚ No (single AP)
      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ Pilot contamination      â”‚ Present but manageable   â”‚ Present and more
  harmful  â”‚
  â”‚ impact                   â”‚ (array gain helps)       â”‚ (no array gain to
  dilute) â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ Backhaul requirement     â”‚ Higher (data to all APs) â”‚ Lower (data to one AP)
      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”˜

  ---
  4.4 Why Small Cells Lose â€” The Physics

  There are three fundamental reasons Cell-Free wins:

  Reason 1: Array Gain (Coherent Combining)

  In Cell-Free, M APs send phase-aligned signals that add up constructively at
  the user. The signal power scales as ~MÂ². In small cells, one AP sends one
  signal â€” no coherent combining, no array gain.

  Cell-Free:   signal power âˆ (Î£_m âˆšÎ·_{mk}Â·Î³_{mk})Â² ~ MÂ²
  Small cell:  signal power âˆ Î·_{d,k} Â· Î³Ì‚_{m_k,k}   ~ 1

  Reason 2: Macro-Diversity (Shadow Fading Protection)

  A user in deep shadow from one AP is likely close to another AP with good
  line-of-sight. Cell-Free exploits ALL APs â€” even if 80% are blocked, the
  remaining 20% provide strong service. Small cells give you one AP â€” if it's
  blocked, you're out of luck.

  User in deep shadow:

    Cell-Free:  APs 1,3,5 blocked â†’ still served by APs 2,4,6,7,...,M
                Rate degradation: mild

    Small cell: AP m_k blocked â†’ rate collapses to near zero
                No fallback

  This is why correlated shadowing (nearby APs tend to be blocked together)
  hurts small cells devastatingly (~10Ã— worse) but barely affects Cell-Free.

  Reason 3: Interference Management

  In Cell-Free, conjugate beamforming naturally directs energy toward the
  intended user and away from others (imperfect but helpful). In small cells,
  each AP transmits omnidirectionally â€” its signal is full interference to every
   other user.

  ---
  4.5 Summary of All Equations in Section V

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Eq.   â”‚ Description                                                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ (38)  â”‚ AP selection: m_k = arg max Î²_{mk} over available APs       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ (39)  â”‚ DL channel estimate decomposition: Ä + Îµ                    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ (40)  â”‚ DL estimation quality Î³Ì‚_{m_k,k}                             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ (41)  â”‚ DL received signal at user k (4 terms)                       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ (42)  â”‚ DL achievable rate (expectation form)                        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ (43)  â”‚ DL rate in closed form: âˆ’logâ‚‚(e)Â·e^{1/Î³Ìƒ}Â·Ei(âˆ’1/Î³Ìƒ)          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ (44)  â”‚ DL effective SINR parameter Î³Ìƒ_{m_k,k}                       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ (45)  â”‚ DL max-min power control problem                             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ (46)  â”‚ Equivalent formulation (max min Î³Ìƒ)                           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ (47)  â”‚ UL rate: âˆ’logâ‚‚(e)Â·e^{1/Î³Ì„}Â·Ei(âˆ’1/Î³Ì„)                        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ (48)  â”‚ UL effective SINR parameter Î³Ì„_{m_k,k}                       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ (49)  â”‚ UL estimation quality Î³_{m_k,k}                              â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ (50)  â”‚ UL max-min power control (quasi-linear)                      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  4.6 What We'll Implement from Section V

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”
  â”‚           Function               â”‚            What it implements
    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ ap_selection(beta)               â”‚ Eq. (38): greedy one-to-one AP assignment
    â”‚
  â”‚                                  â”‚ Returns m_k for each user
   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ sc_dl_rate(gamma_hat, beta,      â”‚ Eqs. (43)â€“(44): closed-form DL rate
   â”‚
  â”‚   eta_d, rho_d, m_index)        â”‚ using expint() in MATLAB
  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ sc_ul_rate(gamma, beta,          â”‚ Eqs. (47)â€“(48): closed-form UL rate
   â”‚
  â”‚   eta_u, rho_u, m_index)        â”‚ using expint()
  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ sc_dl_maxmin_pc(gamma_hat, beta, â”‚ Eq. (46): bisection + LP for DL power
   â”‚
  â”‚   rho_d, m_index)               â”‚ control
  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”¤
  â”‚ sc_ul_maxmin_pc(gamma, beta,     â”‚ Eq. (50): bisection + LP for UL power
   â”‚
  â”‚   rho_u, m_index)               â”‚ control
  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”˜

  ---
  4.7 The Flow from Section V into Section VI

  Section V provides the BASELINE:          Section VI compares:

    Small-cell rates                          CDF of Cell-Free rate
      R_d^{sc} (Eq. 43)                         vs.
      R_u^{sc} (Eq. 47)                      CDF of small-cell rate
    Small-cell power control                    â†’ Figures 3â€“11
      (Eqs. 46, 50)

    Same M APs, same K users,
    same Î²_{mk}, same total power
    â†’ Only difference: cooperation vs. no cooperation

  ---
  This completes the deep dive into Section V. We now have both systems fully
  defined â€” Cell-Free (Sections IIâ€“IV) and Small Cells (Section V). Section VI
  puts them head-to-head with Monte Carlo simulations and CDF plots. Ready to
  proceed to Section VI?

âœ» Baked for 18m 12s