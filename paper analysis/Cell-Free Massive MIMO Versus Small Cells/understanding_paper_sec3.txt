
â•­â”€â”€â”€ Claude Code v2.1.63 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                    â”‚ Tips for getting        â”‚
â”‚             Welcome back Tech Shottify!            â”‚ started                 â”‚
â”‚                                                    â”‚ Run /init to create a â€¦ â”‚
â”‚                       â–â–›â–ˆâ–ˆâ–ˆâ–œâ–Œ                      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                      â–â–œâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–›â–˜                     â”‚ Recent activity         â”‚
â”‚                        â–˜â–˜ â–â–                       â”‚ No recent activity      â”‚
â”‚                                                    â”‚                         â”‚
â”‚               Opus 4.6 Â· Claude Max                â”‚                         â”‚
â”‚   F:\Codes\Awesome-Wireless-Communications-Basic   â”‚                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â¯ read this file:                                                           
  @"paper analysis/Cell-Free Massive MIMO Versus Small                      
  Cells/understanding_paper_sec2.txt" ,                                     
  Now help me to understand section 3 in the same way.                      
  â¿ Â Read paper analysis\Cell-Free Massive MIMO Versus Small 
     Cells\understanding_paper_sec2.txt (1083 lines)

â— I've read the file â€” it contains your previous deep dive into Section II
  (system model, uplink training, downlink/uplink data transmission). Now let me
   prepare the same level of deep dive for Section III (Performance Analysis).

  Let me first re-read the paper's Section III and do thorough research.

â— Agent(Extract Section III from paper)
  â¿ Â Done (7 tool uses Â· 36.8k tokens Â· 2m 18s)
  (ctrl+o to expand)

â— Agent(Research Massive MIMO rate analysis)
  â¿ Â Done (48 tool uses Â· 55.9k tokens Â· 28m 0s)
  (ctrl+o to expand)

â— Now I have thorough research on both the paper content and background theory.
  Let me write the complete deep dive.

  ---
  SECTION III: PERFORMANCE ANALYSIS â€” Complete Deep Dive

  ---
  CHUNK 1: The High-Level Picture & Asymptotic Analysis (Section III-A)

  1.1 What This Section Is About (Simple Terms)

  Section II told us how the system works â€” pilots, beamforming, matched
  filtering. Section III answers: how well does it work? It derives exact
  formulas for the data rate each user can achieve.

  The section has two parts:
  - III-A: What happens when M â†’ âˆ (infinite APs)? This reveals the fundamental
  limits.
  - III-B: What is the exact rate for any finite M and K? This gives the
  formulas we'll actually implement.

  Think of III-A as the "dream scenario" that shows you the theoretical ceiling,
   and III-B as the "real-world formula" that tells you exactly where you stand.

  ---
  1.2 Why Do We Need Rate Expressions?

  In wireless, we measure performance by achievable rate (bits/sec/Hz). A rate
  expression tells us:
  - How much data each user can receive/send
  - How the system scales with M and K
  - Where the bottlenecks are
  - What to optimize (power control, pilot assignment)

  Without closed-form rate expressions, we'd need Monte Carlo simulations for
  every parameter setting â€” impractical for optimization.

  ---
  1.3 The Asymptotic Regime: M â†’ âˆ (Section III-A)

  Let's start from the downlink received signal at user k (from Section II, Eq.
  9):

                  M     K
  r_{d,k} = âˆšÏ_d Â· Î£    Î£  âˆšÎ·_{mk'} Â· g_{mk} Â· Ä*_{mk'} Â· q_{k'}  +  w_{d,k}
                 m=1  k'=1

  Splitting into desired signal (DS) and multi-user interference (MUI):

               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€ DS_k â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ MUI_k â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  M                           M     K
  r_{d,k} = âˆšÏ_dÂ·Î£ âˆšÎ·_{mk}Â·g_{mk}Â·Ä*_{mk}Â·q_k + âˆšÏ_dÂ·Î£    Î£
  âˆšÎ·_{mk'}Â·g_{mk}Â·Ä*_{mk'}Â·q_{k'} + w_{d,k}
                 m=1                         m=1  k'â‰ k

  The key question: What happens to DS_k and MUI_k as M â†’ âˆ?

  ---
  1.4 Tchebyshev's Theorem â€” The Mathematical Engine

  The tool that drives the asymptotic analysis is Tchebyshev's theorem (a form
  of the weak law of large numbers):

  If Xâ‚, Xâ‚‚, ..., Xâ‚™ are independent random variables with E{Xáµ¢} = Î¼áµ¢ and 
  Var{Xáµ¢} â‰¤ c < âˆ for all i, then:

  (1/n)Â·(Xâ‚ + Xâ‚‚ + Â·Â·Â· + Xâ‚™) âˆ’ (1/n)Â·(Î¼â‚ + Î¼â‚‚ + Â·Â·Â· + Î¼â‚™) â†’ 0 in probability

  In words: the average of independent, bounded-variance random variables
  converges to the average of their means. The random fluctuations cancel out.

  Why this matters for Massive MIMO: Each AP contributes one independent term to
   the sum. With M APs (M large), the sum of M independent terms concentrates
  around its mean.

  ---
  1.5 Applying Tchebyshev to the Inner Products

  The critical inner product is (using the channel estimate from Eq. 4):

    M
    Î£  âˆšÎ·_{mk'} Â· g_{mk} Â· Ä*_{mk'}
   m=1

  Substituting Ä_{mk'} = c_{mk'} Â· Å·_{p,mk'} and expanding Å·_{p,mk'}:

    M                              M                               K
    Î£ âˆšÎ·_{mk'}Â·g_{mk}Â·Ä*_{mk'} = Î£ âˆšÎ·_{mk'}Â·c_{mk'}Â·g_{mk}Â·[âˆš(Ï„_pÂ·Ï_p)Â· Î£
  g*_{mi}Â·Ï†*_{k'}Â·Ï†áµ¢ + wÌƒ*_{p,mk'}]
   m=1                            m=1                             i=1

  Each term in the sum over m is independent (different APs have independent
  channels). By Tchebyshev's theorem, as M â†’ âˆ: Eq. (14)

    1   M                                           1   M
   â”€â”€â”€ Â· Î£ âˆšÎ·_{mk'}Â·g_{mk}Â·Ä*_{mk'} âˆ’ âˆš(Ï„_pÂ·Ï_p)Â·â”€â”€â”€ Â· Î£
  âˆšÎ·_{mk'}Â·c_{mk'}Â·Î²_{mk}Â·Ï†*_kÂ·Ï†_{k'} â†’ 0
    M  m=1                                          M  m=1

  Let me explain what happened here:
  - The noise term wÌƒ_{p,mk'} is independent of g_{mk}, so E{g_{mk}Â·wÌƒ*_{p,mk'}} =
   0 â†’ this term vanishes
  - Cross terms g_{mk}Â·g*_{mi} for i â‰  k have E{g_{mk}Â·g*_{mi}} = 0 â†’ these
  vanish too
  - Only the i = k term survives: E{g_{mk}Â·g*_{mk}} = E{|g_{mk}|Â²} = Î²_{mk}

  ---
  1.6 What Survives as M â†’ âˆ

  Applying this to DS_k and MUI_k separately:

  Desired signal (Eq. 15): Setting k' = k:
    1                              1   M
   â”€â”€â”€ Â· DS_k â†’ âˆš(Ï„_pÂ·Ï_pÂ·Ï_d) Â· â”€â”€â”€ Â· Î£ âˆšÎ·_{mk}Â·c_{mk}Â·Î²_{mk} Â· q_k
  (deterministic!)
    M                              M  m=1

  Multi-user interference (Eq. 16): For k' â‰  k:
    1                              1   M
   â”€â”€â”€ Â· MUI_k â†’ âˆš(Ï„_pÂ·Ï_pÂ·Ï_d) Â· Î£  [â”€â”€â”€ Â· Î£ âˆšÎ·_{mk'}Â·c_{mk'}Â·Î²_{mk}] Â·
  Ï†*_kÂ·Ï†_{k'} Â· q_{k'}
    M                             k'â‰ k  M  m=1

  The crucial observation: The interference term has a factor Ï†*k Â· Ï†{k'}.

  - If Ï†*k Â· Ï†{k'} = 0 (orthogonal pilots): Interference vanishes completely! â†’
  Eq. (18)
  - If Ï†*k Â· Ï†{k'} â‰  0 (shared pilots): Interference persists even as M â†’ âˆ â†’
  Eq. (17)

  This is pilot contamination â€” the only impairment that survives infinite M.

  ---
  1.7 Favorable Propagation â€” Why Interference Disappears

  The disappearance of non-coherent interference is called favorable 
  propagation. Physically:

    M
    Î£  g*_{mk} Â· g_{mk'}    (inner product of channel vectors of users k and k')
   m=1

  When k â‰  k' and they use different pilots, Ä_{mk} is independent of g_{mk'}.
  The M terms in the sum are independent with zero mean â†’ by LLN, the sum
  divided by M â†’ 0.

    Users with orthogonal pilots:

         g_k = [g_{1k}, g_{2k}, ..., g_{Mk}]áµ€
         g_{k'} = [g_{1k'}, g_{2k'}, ..., g_{Mk'}]áµ€

         (1/M) Â· g*_k Â· g_{k'} â†’ 0    as M â†’ âˆ

         The channel vectors become orthogonal!

  But when users share a pilot, Ä_{mk} contains a coherent component of g_{mk'}
  (from the contamination). This coherent component adds up constructively
  across all M APs:

    Users sharing pilots:

         Ä_{mk} âˆ c_{mk} Â· (âˆš(Ï„_pÂ·Ï_p) Â· g_{mk} + âˆš(Ï„_pÂ·Ï_p) Â· g_{mk'} + noise)
                                                       â†‘ contamination

         Î£_m g_{mk} Â· Ä*_{mk}  contains  Î£_m |g_{mk}|Â² (desired, ~ M)
         Î£_m g_{mk'} Â· Ä*_{mk} contains  Î£_m Î²_{mk} Â· c_{mk} (contamination,
  also ~ M)

         Both scale linearly with M â†’ ratio saturates â†’ pilot contamination is
  permanent!

  ---
  1.8 Numerical Example â€” Asymptotic Behavior

  Setup: K = 4 users, Ï„_p = 2 pilots â†’ Users {1,3} share pilot 1, Users {2,4}
  share pilot 2.

  As M â†’ âˆ, the downlink signal at User 1 becomes:

  r_{d,1}/âˆšM â†’ âˆš(Ï„_pÂ·Ï_pÂ·Ï_dÂ·M) Â· [
     Î£_m âˆšÎ·_{m1}Â·c_{m1}Â·Î²_{m1} Â· qâ‚           â† desired signal (always present)
   + Î£_m âˆšÎ·_{m3}Â·c_{m3}Â·Î²_{m1} Â· qâ‚ƒ           â† pilot contamination from User 3
   + 0 Â· qâ‚‚                                     â† User 2 (orthogonal pilot):
  GONE
   + 0 Â· qâ‚„                                     â† User 4 (orthogonal pilot):
  GONE
  ]

  Noise: GONE. Interference from Users 2,4: GONE. Only User 3's interference
  survives (same pilot).

  ---
  CHUNK 2: Achievable Downlink Rate â€” Theorem 1 (Section III-B1)

  2.1 The High-Level Picture

  The asymptotic analysis (M â†’ âˆ) tells us what vanishes. But we need a rate
  formula for finite M (e.g., M = 100). This is Theorem 1 â€” the central result
  of the paper.

  The challenge: for finite M, noise, beamforming uncertainty, and all
  interference are present. We need to quantify every source of impairment
  precisely.

  ---
  2.2 The Use-and-Then-Forget (UatF) Bounding Technique

  The key problem: user k does not know the instantaneous effective channel
  gain. In a standard system, the user would estimate the downlink channel.
  Here, thanks to channel hardening, the user relies only on statistics (the
  mean of the effective channel).

  The technique, called the "Use-and-Then-Forget" (UatF) bound:

  1. Use: The AP uses its channel estimate Ä_{mk} for beamforming
  2. Forget: The user decodes as if it only knows E{effective channel}, treating
   all deviations as noise

  The name captures the philosophy: channel estimates are used to design
  beamformers, then forgotten at the decoder.

  ---
  2.3 Signal Decomposition â€” Equations (19)â€“(22)

  The received signal at user k is rewritten as:

  r_{d,k} = DS_k Â· q_k + BU_k Â· q_k + Î£_{k'â‰ k} UI_{kk'} Â· q_{k'} + w_{d,k}
  ... (19)

  where three key quantities are defined:

  DS_k (Desired Signal strength) â€” Eq. (20):
                          M
  DS_k = âˆšÏ_d Â· E{ Î£  âˆšÎ·_{mk} Â· g_{mk} Â· Ä*_{mk} }
                         m=1
  This is the mean of the effective channel gain â€” deterministic, known to the
  user.

  BU_k (Beamforming Uncertainty) â€” Eq. (21):
                   M                           M
  BU_k = âˆšÏ_d Â· [ Î£  âˆšÎ·_{mk}Â·g_{mk}Â·Ä*_{mk} âˆ’ E{ Î£  âˆšÎ·_{mk}Â·g_{mk}Â·Ä*_{mk} } ]
                  m=1                         m=1
  This is the random fluctuation of the effective channel around its mean. The
  user cannot track this â€” it acts as self-interference.

  UI_{kk'} (Inter-User Interference) â€” Eq. (22):
                      M
  UI_{kk'} = âˆšÏ_d Â· Î£  âˆšÎ·_{mk'} Â· g_{mk} Â· Ä*_{mk'}
                     m=1
  This is the leakage from user k' into user k's signal.

  Visually:

  r_{d,k} =  [ DS_k ]  Â· q_k  +  [ BU_k ]  Â· q_k  +   Î£   [ UI_{kk'} ] Â· q_{k'}
   +  w_{d,k}
              â†‘ known              â†‘ unknown              k'â‰ k  â†‘ unknown
           â†‘ noise
              (signal)             (self-interference)          (multi-user
  interference)

  ---
  2.4 Why This Decomposition Works â€” The Worst-Case Noise Argument

  Critical property: DS_k and BU_k are uncorrelated:

  E{DS_k Â· BU*_k} = E{DS_k Â· [a_k âˆ’ E{a_k}]*} = DS_k Â· [E{a*_k} âˆ’ E{a*_k}] = 0

  where a_k = Î£_m âˆšÎ·_{mk} Â· g_{mk} Â· Ä*_{mk} is the effective channel.

  Similarly, UI_{kk'} is uncorrelated with DS_k Â· q_k.

  Now the key information-theoretic argument:

  Among all additive noise distributions with a given variance, Gaussian noise 
  minimizes the mutual information (capacity). Therefore, replacing the actual 
  non-Gaussian effective noise (BU + UI + thermal) with Gaussian noise of the 
  same power gives a valid lower bound on the achievable rate.

  This yields: Eq. (23)

                           |DS_k|Â²
  R_{d,k} = logâ‚‚(1 + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ )
                       E{|BU_k|Â²} + Î£_{k'â‰ k} E{|UI_{kk'}|Â²} + 1

  The structure is:

           (signal power from the KNOWN part of the channel)
  SINR = â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         (variance of channel uncertainty) + (interference power) + (noise)

  ---
  2.5 Computing Each Term â€” The Proof of Theorem 1

  Now we compute DS_k, E{|BU_k|Â²}, and E{|UI_{kk'}|Â²} in closed form. This is
  Appendix A of the paper. Let me walk through each.

  Step 1: Compute DS_k (Eq. 59)

  Using the decomposition g_{mk} = Ä_{mk} + Îµ_{mk} (estimate + error), where
  Ä_{mk} and Îµ_{mk} are independent (MMSE property):

                      M
  DS_k = âˆšÏ_d Â· E{ Î£  âˆšÎ·_{mk} Â· (Ä_{mk} + Îµ_{mk}) Â· Ä*_{mk} }
                     m=1

                M
       = âˆšÏ_d Â· Î£  âˆšÎ·_{mk} Â· ( E{|Ä_{mk}|Â²} + E{Îµ_{mk}} Â· E{Ä*_{mk}} )
                m=1                  â†‘                    â†‘
                                  = Î³_{mk}             = 0 (zero mean,
  independent)

                M
       = âˆšÏ_d Â· Î£  âˆšÎ·_{mk} Â· Î³_{mk}                                        ...
  (59)
                m=1

  Step 2: Compute E{|BU_k|Â²} (Eq. 60)

  BU_k is the sum of M independent zero-mean terms (centered by subtracting
  DS_k). The variance of a sum of independent RVs equals the sum of variances:

  E{|BU_k|Â²} = Ï_d Â· Î£_{m=1}^{M} Î·_{mk} Â· Var{g_{mk} Â· Ä*_{mk}}

  For each term:
  Var{g_{mk} Â· Ä*_{mk}} = E{|g_{mk} Â· Ä*_{mk}|Â²} âˆ’ |E{g_{mk} Â· Ä*_{mk}}|Â²
                          = E{|g_{mk}|Â² Â· |Ä_{mk}|Â²} âˆ’ Î³Â²_{mk}

  Using g_{mk} = Ä_{mk} + Îµ_{mk}:
  E{|g_{mk}|Â² Â· |Ä_{mk}|Â²} = E{|Ä_{mk} + Îµ_{mk}|Â² Â· |Ä_{mk}|Â²}
                              = E{|Ä_{mk}|â´} + E{|Îµ_{mk}|Â²} Â· E{|Ä_{mk}|Â²}
                                    â†‘                â†‘              â†‘
                                 = 2Î³Â²_{mk}    = Î²_{mk}âˆ’Î³_{mk}   = Î³_{mk}

  (For a CN(0,ÏƒÂ²) variable X: E{|X|â´} = 2Ïƒâ´. This is the fourth moment of a
  complex Gaussian.)

  So:
  Var{g_{mk}Â·Ä*_{mk}} = 2Î³Â²_{mk} + (Î²_{mk} âˆ’ Î³_{mk})Â·Î³_{mk} âˆ’ Î³Â²_{mk}
                        = Î³Â²_{mk} + Î²_{mk}Â·Î³_{mk} âˆ’ Î³Â²_{mk}
                        = Î³_{mk} Â· Î²_{mk}

  Therefore: Eq. (60)
  E{|BU_k|Â²} = Ï_d Â· Î£_{m=1}^{M} Î·_{mk} Â· Î³_{mk} Â· Î²_{mk}

  Step 3: Compute E{|UI_{kk'}|Â²} (Eqs. 61â€“68)

  This is the most involved step. The interference from user k' has two
  components:
  - A coherent part (from pilot contamination, when Ï†*k Â· Ï†{k'} â‰  0)
  - An incoherent part (always present)

  After careful derivation (expanding the estimate, using independence of
  channels across APs, and the fourth moment formula): Eq. (68)

                                                             M
                          M
  E{|UI_{kk'}|Â²} = Ï_d Â· |Ï†*_k Â· Ï†_{k'}|Â² Â· ( Î£  âˆšÎ·_{mk'} Â· Î³_{mk'} Â·
  Î²_{mk}/Î³_{mk'} )Â²  +  Ï_d Â· Î£  Î·_{mk'} Â· Î³_{mk'} Â· Î²_{mk}
                                                            m=1
                         m=1

  The first term is the coherent interference (pilot contamination) â€” note it's
  a squared sum, scaling as MÂ². The second term is incoherent interference â€” a
  simple sum, scaling as M.

  ---
  2.6 Putting It All Together â€” Theorem 1, Eq. (24)

  Substituting DS_k, E{|BU_k|Â²}, and E{|UI_{kk'}|Â²} into Eq. (23): THE CENTRAL 
  EQUATION

                                          Ï_d Â· ( Î£_{m=1}^{M} âˆšÎ·_{mk} Â· Î³_{mk}
  )Â²
  R_{d,k} = logâ‚‚( 1 + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ )
                        Ï_d Â· Î£_{k'=1}^{K} Î£_{m=1}^{M} Î·_{mk'} Â· Î³_{mk'} Â·
  Î²_{mk}
                        + Ï_d Â· Î£_{k'â‰ k} |Ï†*_kÂ·Ï†_{k'}|Â² Â· ( Î£_{m=1}^{M}
  âˆšÎ·_{mk'}Â·c_{mk'}Â·Î²_{mk} )Â²
                        + 1

  Let me label each part of the denominator:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  NUMERATOR:  Ï_d Â· ( Î£_m âˆšÎ·_{mk} Â· Î³_{mk} )Â²                      â”‚
  â”‚              â†‘ Squared sum of coherent gains from all M APs          â”‚
  â”‚              This is |DS_k|Â² â€” the signal power                      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  DENOMINATOR TERM 1:  Ï_d Â· Î£_{k'} Î£_m Î·_{mk'} Â· Î³_{mk'} Â· Î²_{mk} â”‚
  â”‚              â†‘ Non-coherent interference + beamforming uncertainty    â”‚
  â”‚              This = E{|BU_k|Â²} + incoherent part of Î£ E{|UI_{kk'}|Â²}â”‚
  â”‚              Scales as O(M) â€” grows linearly                         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  DENOMINATOR TERM 2:  Ï_d Â· Î£_{k'â‰ k} |Ï†*_kÂ·Ï†_{k'}|Â² Â· (...)Â²      â”‚
  â”‚              â†‘ Coherent pilot contamination interference              â”‚
  â”‚              Only from co-pilot users (|Ï†*_kÂ·Ï†_{k'}|Â² = 1)           â”‚
  â”‚              This is a SQUARED SUM â€” scales as O(MÂ²)                 â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  DENOMINATOR TERM 3:  1  =  noise                                    â”‚
  â”‚              â†‘ Thermal noise (constant, doesn't scale with M)         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Scaling behavior as M â†’ âˆ:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚           Component            â”‚ Scaling â”‚            Effect            â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Numerator (signal)             â”‚ O(MÂ²)   â”‚ Grows quadratically          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Denom Term 1 (non-coherent)    â”‚ O(M)    â”‚ Drowned out by numerator     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Denom Term 2 (pilot            â”‚ O(MÂ²)   â”‚ Stays competitive with       â”‚
  â”‚ contamination)                 â”‚         â”‚ numerator                    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Denom Term 3 (noise)           â”‚ O(1)    â”‚ Completely negligible        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  As M â†’ âˆ:   SINR â†’ (Î£_m âˆšÎ·_{mk}Â·Î³_{mk})Â² / Î£_{k'â‰ k,co-pilot} (Î£_m
  âˆšÎ·_{mk'}Â·c_{mk'}Â·Î²_{mk})Â²

  The rate saturates â€” it doesn't grow forever. Pilot contamination creates a 
  ceiling.

  ---
  2.7 Numerical Example â€” Downlink Rate Computation

  Setup: M = 4 APs, K = 2 users, Ï„_p = 1 (both users share the same pilot!), Ï_d
   = 10 dB = 10.

  Large-scale fading:

  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚      â”‚ Î²_{m1} â”‚ Î²_{m2} â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ AP 1 â”‚ 0.5    â”‚ 0.1    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ AP 2 â”‚ 0.3    â”‚ 0.4    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ AP 3 â”‚ 0.1    â”‚ 0.6    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ AP 4 â”‚ 0.2    â”‚ 0.2    â”‚
  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  With Ï„_p = 1 and both users sharing the pilot (|Ï†*â‚Â·Ï†â‚‚|Â² = 1):

  MMSE coefficient: c_{mk} = âˆš(Ï„_pÂ·Ï_p) Â· Î²_{mk} / (Ï„_pÂ·Ï_p Â· (Î²_{m1} + Î²_{m2})
  + 1)

  Let Ï_p = 10 (training SNR = 10 dB), so Ï„_pÂ·Ï_p = 10.

  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  m  â”‚ Î²_{m1}+Î²_{m2} â”‚   c_{m1}   â”‚   c_{m2}   â”‚    Î³_{m1}     â”‚ Î³_{m2} â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 1   â”‚ 0.6           â”‚ âˆš10Â·0.5/7  â”‚ âˆš10Â·0.1/7  â”‚ 10Â·0.5Â·0.226  â”‚ 0.045  â”‚
  â”‚     â”‚               â”‚ = 0.226    â”‚ = 0.045    â”‚ = 1.13        â”‚        â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 2   â”‚ 0.7           â”‚ âˆš10Â·0.3/8  â”‚ âˆš10Â·0.4/8  â”‚ 0.356         â”‚ 0.632  â”‚
  â”‚     â”‚               â”‚ = 0.119    â”‚ = 0.158    â”‚               â”‚        â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 3   â”‚ 0.7           â”‚ âˆš10Â·0.1/8  â”‚ âˆš10Â·0.6/8  â”‚ 0.040         â”‚ 1.424  â”‚
  â”‚     â”‚               â”‚ = 0.040    â”‚ = 0.237    â”‚               â”‚        â”‚
  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 4   â”‚ 0.4           â”‚ âˆš10Â·0.2/5  â”‚ âˆš10Â·0.2/5  â”‚ 0.253         â”‚ 0.253  â”‚
  â”‚     â”‚               â”‚ = 0.126    â”‚ = 0.126    â”‚               â”‚        â”‚
  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  (Approximate values for illustration.)

  With equal power control Î·_{mk} = 1/(KÂ·max_m Î³_{mk}):

  Numerator for user 1: Ï_d Â· (Î£_m âˆšÎ·_{m1}Â·Î³_{m1})Â² â€” the coherent sum of all
  APs' contributions.

  The point: every quantity in Eq. (24) is computable from the large-scale 
  fading coefficients Î²_{mk} alone. No instantaneous channel knowledge needed.

  ---
  2.8 Remark 3 â€” Connection to Collocated Massive MIMO (Eq. 25)

  If all APs are collocated (same location): Î²_{mk} = Î²_k for all m, Î³_{mk} =
  Î³_k for all m. With a total (not per-AP) power constraint and orthogonal
  pilots:

                             M Â· Ï_d Â· Î·_k Â· Î³_k
  R_{d,k} = logâ‚‚( 1 + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ )                    ... (25)
                        Ï_d Â· Î£_{k'} Î·_{k'} + 1

  This is the classical collocated Massive MIMO rate from [3] (Ngo, Larsson,
  Marzetta, 2013). So Cell-Free is a strict generalization â€” collocated is a
  special case.

  ---
  2.9 Remark 4 â€” Channel Hardening Validation (Fig. 2, Eq. 26)

  To verify that the user can safely decode using only statistics (not
  instantaneous channel), the paper compares:

  - Eq. (24): Rate assuming user knows only E{effective channel} (the UatF
  bound)
  - Eq. (26): Rate assuming a "genie" tells the user the exact instantaneous
  effective channel

                                      Ï_d Â· | Î£_m âˆšÎ·_{mk}Â·g_{mk}Â·Ä*_{mk} |Â²
  RÌƒ_{d,k} = E{ logâ‚‚( 1 + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ )
  }     ... (26)
                            Î£_{k'â‰ k} | Î£_m âˆšÎ·_{mk'}Â·g_{mk}Â·Ä*_{mk'} |Â² + 1

  Figure 2 shows the gap is small (a few percent), confirming channel hardening
  works. The intuition: with M = 100 APs, the effective channel Î£_m
  âˆšÎ·_{mk}Â·g_{mk}Â·Ä*_{mk} is a sum of ~100 independent terms. By the law of large
   numbers, this sum concentrates around its mean. The "randomness" is small
  relative to the mean.

  Important nuance: Channel hardening is weaker in Cell-Free than in collocated
  systems. In collocated, all M terms have the same variance (same Î²_k), giving
  variance/meanÂ² = 1/M. In Cell-Free, the Î²_{mk} values vary widely â€” nearby APs
   dominate. The "effective number" of APs is ~10-20, not 100. But this is still
   enough for hardening to work reasonably well.

  ---
  CHUNK 3: Achievable Uplink Rate â€” Theorem 2 (Section III-B2)

  3.1 The High-Level Picture

  The uplink rate derivation follows the same philosophy as the downlink:
  decompose the signal, treat deviations from the mean as noise, apply the
  worst-case Gaussian argument. But the uplink has a different signal structure
  (combining happens at the CPU, not over the air).

  ---
  3.2 The Uplink SINR â€” Theorem 2, Eq. (27)

  The CPU detects user k from the combined signal r_{u,k} = Î£_{m=1}^{M} Ä*{mk} Â·
   y{u,m} (from Eq. 11). Using the same UatF technique:

                                          Ï_u Â· p_k Â· ( Î£_{m=1}^{M} Î³_{mk} )Â²
  R_{u,k} = logâ‚‚( 1 + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ )
                        Ï_u Â· Î£_{k'â‰ k} p_{k'} Â· |Ï†*_kÂ·Ï†_{k'}|Â² Â· ( Î£_{m=1}^{M}
  Î³_{mk}Â·Î²_{mk'}/Î³_{mk'} )Â²
                        + Ï_u Â· Î£_{k'=1}^{K} p_{k'} Â· Î£_{m=1}^{M} Î³_{mk} Â·
  Î²_{mk'}
                        + Î£_{m=1}^{M} Î³_{mk}
  ... (27)

  where p_k âˆˆ [0, 1] is the uplink power control coefficient for user k.

  ---
  3.3 Comparing Downlink vs. Uplink SINR Structure

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”
  â”‚    Component     â”‚        Downlink (Eq. 24)      â”‚       Uplink (Eq. 27)
      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”¤
  â”‚ Numerator        â”‚ Ï_dÂ·(Î£_m âˆšÎ·_{mk}Â·Î³_{mk})Â²   â”‚ Ï_uÂ·p_kÂ·(Î£_m Î³_{mk})Â²
   â”‚
  â”‚                  â”‚ â†‘ power control per AP-user   â”‚ â†‘ no per-AP power control
       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”¤
  â”‚ Pilot contam.    â”‚ |Ï†*_kÂ·Ï†_{k'}|Â²Â·              â”‚ |Ï†*_kÂ·Ï†_{k'}|Â²Â·
     â”‚
  â”‚ (coherent)       â”‚ (Î£_m âˆšÎ·_{mk'}Â·c_{mk'}Â·Î²_{mk})Â²â”‚ (Î£_m
  Î³_{mk}Â·Î²_{mk'}/Î³_{mk'})Â²â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”¤
  â”‚ Non-coherent     â”‚ Î£_{k'} Î£_m Î·_{mk'}Â·Î³_{mk'}  â”‚ Î£_{k'} p_{k'}Â·
   â”‚
  â”‚ interference     â”‚         Â·Î²_{mk}               â”‚   Î£_m Î³_{mk}Â·Î²_{mk'}
     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”¤
  â”‚ Noise            â”‚ 1                              â”‚ Î£_m Î³_{mk}
       â”‚
  â”‚                  â”‚                                â”‚ (noise amplified by MF)
        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”¤
  â”‚ Power control    â”‚ Î·_{mk} (M Ã— K variables)      â”‚ p_k (K variables)
       â”‚
  â”‚ complexity       â”‚                                â”‚
        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”˜

  Key differences:

  1. Power control granularity: Downlink has MÃ—K power coefficients Î·_{mk} (one
  per AP-user pair). Uplink has only K coefficients p_k (one per user). Uplink
  optimization is much simpler.
  2. Numerator structure: In downlink, âˆšÎ·_{mk} appears inside the sum â€” each AP
  can weight its contribution to each user differently. In uplink, p_k is
  outside the sum â€” the user broadcasts with a single power level.
  3. Noise term: In downlink, noise at the user is just 1. In uplink, noise at
  the CPU after matched filtering is Î£_m Î³_{mk} â€” each AP's matched filter
  amplifies noise by Î³_{mk}, and these add up.

  ---
  3.4 Why the Uplink Numerator Has (Î£_m Î³_{mk})Â² Instead of (Î£_m 
  âˆšÎ·_{mk}Â·Î³_{mk})Â²

  In the uplink, the matched filter weight at AP m is Ä*_{mk} (fixed by the
  channel estimate, not by power control). The CPU simply adds up all APs'
  contributions. So the mean effective channel is:

                  M                           M
  E{r_{u,k}} = Î£  E{Ä*_{mk} Â· g_{mk}} = Î£  Î³_{mk}
                 m=1                         m=1

  No power control coefficient appears here â€” p_k only scales the overall
  signal. That's why the uplink numerator is p_k Â· (Î£_m Î³_{mk})Â².

  In contrast, for the downlink, AP m can independently control how much power
  it allocates to user k via Î·_{mk}, so âˆšÎ·_{mk} appears inside the sum.

  ---
  3.5 Remark 5 â€” Collocated Special Case (Eq. 28)

  With collocated APs and orthogonal pilots (same simplification as Remark 3):

                            Ï_u Â· M Â· p_k Â· Î³_k
  R_{u,k} = logâ‚‚( 1 + â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ )                    ... (28)
                        Ï_u Â· Î£_{k'} p_{k'} Â· Î²_{k'} + 1

  This matches the classical collocated Massive MIMO uplink rate from Ngo et al.
   [21] and Hoydis et al. [36].

  ---
  CHUNK 4: Key Insights, Physical Interpretation & Summary

  4.1 The Big Picture â€” What Section III Tells Us

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                   PERFORMANCE HIERARCHY                          â”‚
  â”‚                                                                  â”‚
  â”‚   M â†’ âˆ, orthogonal pilots:  SINR â†’ âˆ  (unlimited rate)        â”‚
  â”‚          â†‘ noise + all interference vanish                       â”‚
  â”‚                                                                  â”‚
  â”‚   M â†’ âˆ, reused pilots:     SINR â†’ finite  (rate ceiling)       â”‚
  â”‚          â†‘ only pilot contamination remains                      â”‚
  â”‚                                                                  â”‚
  â”‚   Finite M, optimized:      SINR = Theorem 1 or 2               â”‚
  â”‚          â†‘ all impairments present, but quantified               â”‚
  â”‚                                                                  â”‚
  â”‚   Finite M, no optimization: worst performance                   â”‚
  â”‚          â†‘ power control and pilot assignment matter hugely       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  4.2 Why Î³_{mk} Is the Most Important Quantity

  The quantity Î³_{mk} = E{|Ä_{mk}|Â²} = Ï„_pÂ·Ï_pÂ·Î²Â²_{mk} / (Ï„_pÂ·Ï_pÂ·Î£_{k'âˆˆğ’«k} 
  Î²{mk'} + 1) appears everywhere:

  - In the numerator of both DL and UL SINR
  - In the power constraint
  - In the interference terms
  - In the definition of c_{mk}

  Î³_{mk} captures the quality of channel estimation between AP m and user k. It
  depends on:
  - Î²_{mk}: how strong the channel is (distance-dependent)
  - Î£_{k'âˆˆğ’«k} Î²{mk'}: how much pilot contamination there is (other users on the
  same pilot)
  - Ï„_pÂ·Ï_p: training resources (pilot length Ã— pilot power)

  Good estimation (large Î³_{mk}) when:
  - User k is close to AP m (large Î²_{mk})
  - Few co-pilot users are near AP m (small contamination)
  - Plenty of training resources

  ---
  4.3 The Three Impairments â€” A Summary Table

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”
  â”‚     Impairment       â”‚   Physical cause   â”‚ Scales with M  â”‚     Can be
  fixed?    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Beamforming          â”‚ Imperfect channel  â”‚ O(M) â€” drowned â”‚ Improves with
  better â”‚
  â”‚ uncertainty (BU)     â”‚ estimation         â”‚ out by signal  â”‚ estimation
  (more Ï„_p)â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Non-coherent         â”‚ Multi-user         â”‚ O(M) â€” drowned â”‚ Vanishes as M â†’
   âˆ   â”‚
  â”‚ interference         â”‚ interference       â”‚ out by signal  â”‚ (favorable
  propagationâ”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Coherent (pilot      â”‚ Pilot reuse        â”‚ O(MÂ²) â€” same   â”‚ Can be reduced
  by    â”‚
  â”‚ contamination)       â”‚                    â”‚ rate as signal â”‚ pilot
  assignment, NOT â”‚
  â”‚                      â”‚                    â”‚                â”‚ eliminated with
   MF/CB â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Thermal noise        â”‚ Physics            â”‚ O(1) â€” negligibleâ”‚ Overwhelmed
  by array â”‚
  â”‚                      â”‚                    â”‚ for large M    â”‚ gain
         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â”€â”€â”€â”€â”˜

  ---
  4.4 Figure 2 â€” Channel Hardening Confirmation

      Rate
      (b/s/Hz)
       â”‚
     8 â”¤                                     ___________  â† K=10, genie-aided
  (Eq.26)
       â”‚                                 ___/
     7 â”¤                              __/ ____________    â† K=10, statistics
  only (Eq.24)
       â”‚                           __/ __/
     6 â”¤                         _/ __/
       â”‚                       _/ _/       small gap â†’ hardening works!
     5 â”¤                     _/ _/
       â”‚                   _/ _/      ___________  â† K=20, genie-aided
     4 â”¤                 _/ _/    ___/
       â”‚               _/ _/  ___/ ___________    â† K=20, statistics only
     3 â”¤             _/ _/ __/ __/
       â”‚           _/ _/__/ __/
     2 â”¤         _/ _/_/ __/
       â”‚       _/_/_/ __/
     1 â”¤    __/__/ __/
       â”‚ __/__/ __/
     0 â”¤â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â†’ M (number of APs)
       0  50 100 150 200 250 300 350 400

  The two curves (genie-aided vs. statistics-only) are very close, confirming
  that:
  1. Channel hardening makes the effective channel nearly deterministic
  2. Downlink pilots are unnecessary
  3. The UatF bound (Eq. 24) is tight in practice

  ---
  4.5 What We'll Implement from Section III

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚          Function                  â”‚          What it computes            â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ compute_gamma(beta, pilot_idx,     â”‚ Î³_{mk} for all m,k from Eq. (8)     â”‚
  â”‚   tau_p, rho_p)                    â”‚                                      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ compute_dl_rate(gamma, beta, eta,  â”‚ R_{d,k} from Theorem 1, Eq. (24)    â”‚
  â”‚   pilot_idx, rho_d)               â”‚                                      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ compute_ul_rate(gamma, beta, p,    â”‚ R_{u,k} from Theorem 2, Eq. (27)    â”‚
  â”‚   pilot_idx, rho_u)               â”‚                                      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ compute_genie_rate(g, g_hat, eta,  â”‚ RÌƒ_{d,k} from Eq. (26) via Monte     â”‚
  â”‚   rho_d)                          â”‚ Carlo                                 â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ plot_hardening_validation(M_range, â”‚ Reproduce Figure 2                   â”‚
  â”‚   K_values)                       â”‚                                       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  4.6 Summary: The Flow from Section II to Section III

  Section II (System Model)              Section III (Performance Analysis)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  Channel: g_{mk} = âˆšÎ²_{mk}Â·h_{mk}  â†’  Asymptotic: as Mâ†’âˆ, only pilot
                                         contamination survives (III-A)

  Estimation: Ä_{mk} = c_{mk}Â·Å·_{mk} â†’ Î³_{mk} = E{|Ä_{mk}|Â²} feeds into
                                         every rate expression

  DL beamforming: x_m = Î£ âˆšÎ·_{mk}Â·  â†’  Theorem 1 (Eq. 24): closed-form
    Ä*_{mk}Â·q_k                         DL rate for any M,K

  UL matched filter: rÌ‚_{mk} =        â†’  Theorem 2 (Eq. 27): closed-form
    Ä*_{mk}Â·y_{u,m}                     UL rate for any M,K

                                         Both use UatF bound + worst-case
                                         Gaussian noise argument

  ---
  This completes the deep dive into Section III. The rate expressions (Eqs. 24
  and 27) are the formulas we'll code in MATLAB â€” they depend only on the
  large-scale fading coefficients Î²_{mk}, power control coefficients, and pilot
  assignments. Section IV (next) will show how to optimize the power control and
   pilot assignment to maximize these rates. Ready to proceed?

âœ» Cooked for 17m 34s

â¯ /export paper analysis\Cell-Free Massive MIMO Versus Small 
Cells\understanding_paper_sec2.txt 
  â¿  Conversation exported to: paper analysis\Cell-Free Massive MIMO Versus
     Small Cells\understanding_paper_sec2.txt